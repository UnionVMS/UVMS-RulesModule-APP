<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.3.xsd">

    <changeSet id="UNIONVMS-4660-template-for-MovementRules" author="nomikosi">
        <insert tableName="template">
            <column name="template_id" value="2000" />
            <column name="template_name" value="Movement report document" />
            <column name="fact_template" value="MOVEMENT_REPORT_DOCUMENT" />
        </insert>
        <insert tableName="template">
            <column name="template_id" value="2001" />
            <column name="template_name" value="Movement report document id" />
            <column name="fact_template" value="MOVEMENT_REPORT_DOCUMENT_ID" />
        </insert>

        <rollback>
            <delete tableName="template">
                <where>template_id = 2000</where>
            </delete>
            <delete tableName="template">
                <where>template_id = 2001</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L00-00-0001" author="nomikosi">
        <insert tableName="rule">
            <column name="template_id" value="2000" />
            <column name="property_names" value="id" />
            <column name="note" value="Check presence. Must be present." />
            <column name="level" value="L00" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L00-00-0001" />
            <column name="rule_id" value="20001"/>
        </insert>
        <insert tableName="context_expression">
            <column name="expression" value="ids == null || ids.isEmpty()"/>
            <column name="failure_message" value="Message creation date/time missing."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20001"/>
            <column name="id" value="20001"/>
        </insert>

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20001</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L00-00-0001'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0002" author="nomikosi">
        <insert tableName="rule">
            <column name="template_id" value="2000" />
            <column name="property_names" value="id" />
            <column name="note" value="Format must be date in UTC according to ISO8601" />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0002" />
            <column name="rule_id" value="20002"/>
        </insert>
        <insert tableName="context_expression">
            <column name="expression" value="ids != null &amp;&amp; !ids.isEmpty() &amp;&amp; !containsTypesOfIdXTimes(ids,&quot;UUID&quot;,1)"/>
            <column name="failure_message" value="Invalid message creation date/time."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20002"/>
            <column name="id" value="20002"/>
        </insert>

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20002</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0002'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0003" author="nomikosi">
        <insert  tableName="rule">
            <column name="template_id" value="2001" />
            <column name="property_names" value="id" />
            <column name="note" value="Check Format of the value. Must be according to the specified schemeID." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0003" />
            <column name="rule_id" value="20003"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="id != null &amp;&amp; !uuidValidateRegex(id)"/>
            <column name="failure_message" value="Check Format of the value. Must be according to the specified schemeID."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20003"/>
            <column name="id" value="20003"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20003</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0003'</where>
            </delete>
        </rollback>
    </changeSet>    
    
    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0006" author="gmanifavas">
        <insert  tableName="rule">
            <column name="template_id" value="2000" />
            <column name="property_names" value="creationDateTime" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0006" />
            <column name="rule_id" value="20006"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="creationDateTimeString != null &amp;&amp; !hasValidCreationDateTime(creationDateTimeString)"/>
            <column name="failure_message" value="Message creation date/time must be a valid UTC date/time in the correct format."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20006"/>
            <column name="id" value="20006"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20006</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0006'</where>
            </delete>
        </rollback>
    </changeSet>


    <changeSet id="UNIONVMS-4660-update-VP-L03-00-0007" author="nomikosi">
        <insert  tableName="rule">
            <column name="template_id" value="2000" />
            <column name="property_names" value="CreationDateTime" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L03" />
            <column name="error_type" value="WARNING" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L03-00-0007" />
            <column name="rule_id" value="20007"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="creationDateTime != null &amp;&amp; !isDateInThePast(creationDateTime)"/>
            <column name="failure_message" value="Message creation date/time not in the past."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20007"/>
            <column name="id" value="20007"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20007</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L03-00-0007'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L00-00-0006" author="gmanifavas">
        <insert  tableName="rule">
            <column name="template_id" value="2000" />
            <column name="property_names" value="purposeCode" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L00" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L00-00-0006" />
            <column name="rule_id" value="30006"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="purposeCode == null || purposeCode.getValue() == null || purposeCode.getValue().trim().isEmpty()"/>
            <column name="failure_message" value="Message PurposeCode missing."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="30006"/>
            <column name="id" value="30006"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 30006</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L00-00-0006'</where>
            </delete>
        </rollback>
    </changeSet>
    
    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0009" author="gmanifavas">
        <insert  tableName="rule">
            <column name="template_id" value="2000" />
            <column name="property_names" value="purposeCode" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0009" />
            <column name="rule_id" value="20009"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="purposeCode != null &amp;&amp; !hasValidPurposeCodeListId(purposeCode, &quot;FLUX_GP_PURPOSE&quot;)"/>
            <column name="failure_message" value="PurposeCode has an invalid listID."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20009"/>
            <column name="id" value="20009"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20009</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0009'</where>
            </delete>
        </rollback>
    </changeSet>  
    
    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0010" author="gmanifavas">
        <insert  tableName="rule">
            <column name="template_id" value="2000" />
            <column name="property_names" value="purposeCode" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0010" />
            <column name="rule_id" value="20010"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="purposeCode != null &amp;&amp; purposeCode.getValue() != null &amp;&amp; !purposeCode.getValue().trim().isEmpty() &amp;&amp; !hasValidPurposeCodeValue(purposeCode, &quot;9&quot;)"/>
            <column name="failure_message" value="PurposeCode has an invalid value."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20010"/>
            <column name="id" value="20010"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20010</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0010'</where>
            </delete>
        </rollback>
    </changeSet> 
    
    <changeSet id="UNIONVMS-4660-update-VP-L00-00-0020" author="gmanifavas">
        <insert  tableName="rule">
            <column name="template_id" value="2000" />
            <column name="property_names" value="OwnerFLUXParty" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L00" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L00-00-0020" />
            <column name="rule_id" value="30020"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="ownerFLUXParty == null || (ownerFLUXParty.getIDS() != null &amp;&amp; ownerFLUXParty.getIDS().isEmpty())"/>
            <column name="failure_message" value="Message Owner ID missing."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="30020"/>
            <column name="id" value="30020"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 30020</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L00-00-0020'</where>
            </delete>
        </rollback>
    </changeSet>


    <changeSet id="UNIONVMS-4660-update-template-2002" author="gmanifavas">
        <insert tableName="template">
            <column name="template_id" value="2002" />
            <column name="template_name" value="Movement Report Document Owner Flux Party Id" />
            <column name="fact_template" value="MOVEMENT_REPORT_DOC_OWNER_FLUX_PARTY_ID" />
        </insert>
        
        <rollback>
            <delete tableName="template">
                <where>template_id = 2002</where>
            </delete>
        </rollback>
    </changeSet>
    
    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0021" author="gmanifavas">
        
        <insert  tableName="rule">
            <column name="template_id" value="2002" />
            <column name="property_names" value="ownerFluxPartyId" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0021" />
            <column name="rule_id" value="20021"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="id != null &amp;&amp; !hasValidSchemeID(id, &quot;FLUX_GP_PARTY&quot;)"/>
            <column name="failure_message" value="Message Owner ID has an invalid schemeID."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20021"/>
            <column name="id" value="20021"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20021</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0021'</where>
            </delete>
        </rollback>
    </changeSet>  
    
    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0022" author="gmanifavas">
        
        <insert  tableName="rule">
            <column name="template_id" value="2002" />
            <column name="property_names" value="ownerFluxPartyId" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0022" />
            <column name="rule_id" value="20022"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="id != null &amp;&amp; !mdrService.isPresentInMDRList(id.getSchemeID(), id.getValue(), creationDateTime)"/>
            <column name="failure_message" value="Message Owner ID does not exist."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20022"/>
            <column name="id" value="20022"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20022</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0022'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-template-2004" author="tpotopapas">
        <insert tableName="template">
            <column name="template_id" value="2004" />
            <column name="template_name" value="Movement Vessel Position Event" />
            <column name="fact_template" value="MOVEMENT_SPECIFIED_VESSEL_POSITION_EVENT" />
        </insert>

        <rollback>
            <delete tableName="template">
                <where>template_id = 2004</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0031" author="tprotopapas">

        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="typeCode" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0031" />
            <column name="rule_id" value="20031"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="typeCode != null &amp;&amp; typeCode.listID != &quot;FLUX_VESSEL_POSITION_TYPE&quot; "/>
            <column name="failure_message" value="Invalid schemeID for VesselPositionEvent/TypeCode."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20031"/>
            <column name="id" value="20031"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20031</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0031'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0032" author="tprotopapas">

        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="typeCode, creationDateTime" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0032" />
            <column name="rule_id" value="20032"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listID, typeCode.value, creationDateTime)"/>
            <column name="failure_message" value="Invalid code for VesselPositionEvent/TypeCode."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20032"/>
            <column name="id" value="20032"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20032</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-20032'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0321" author="tprotopapas">

        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="speedValue" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0321" />
            <column name="rule_id" value="20321"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="speedValue != null &amp;&amp; !hasValidSpeedValue(speedValue)"/>
            <column name="failure_message" value="Invalid speed value."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20321"/>
            <column name="id" value="20321"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20321</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0321'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0331" author="tprotopapas">

        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="courseValue" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0331" />
            <column name="rule_id" value="20331"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="courseValue != null &amp;&amp; !hasValidCourseValue(courseValue)"/>
            <column name="failure_message" value="Invalid course value."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20331"/>
            <column name="id" value="20331"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20331</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0331'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0311" author="tprotopapas">
        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="creationDateTimeString" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0311" />
            <column name="rule_id" value="20311"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="creationDateTimeString != null &amp;&amp; !hasValidCreationDateTime(creationDateTimeString)"/>
            <column name="failure_message" value="Occurrence date/time must be a valid UTC date/time in the correct format."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20311"/>
            <column name="id" value="20311"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20311</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0311'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-template-2004" author="tpotopapas">
        <insert tableName="template">
            <column name="template_id" value="2004" />
            <column name="template_name" value="Movement Vessel Position Event" />
            <column name="fact_template" value="MOVEMENT_SPECIFIED_VESSEL_POSITION_EVENT" />
        </insert>

        <rollback>
            <delete tableName="template">
                <where>template_id = 2004</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0031" author="tprotopapas">

        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="typeCode" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0031" />
            <column name="rule_id" value="20031"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="typeCode != null &amp;&amp; typeCode.listID != &quot;FLUX_VESSEL_POSITION_TYPE&quot; "/>
            <column name="failure_message" value="Invalid schemeID for VesselPositionEvent/TypeCode."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20031"/>
            <column name="id" value="20031"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20031</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0031'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0032" author="tprotopapas">

        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="typeCode, creationDateTime" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0032" />
            <column name="rule_id" value="20032"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listID, typeCode.value, creationDateTime)"/>
            <column name="failure_message" value="Invalid code for VesselPositionEvent/TypeCode."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20032"/>
            <column name="id" value="20032"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20032</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-20032'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0321" author="tprotopapas">

        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="speedValue" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0321" />
            <column name="rule_id" value="20321"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="speedValue != null &amp;&amp; !hasValidSpeedValue(speedValue)"/>
            <column name="failure_message" value="Invalid speed value."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20321"/>
            <column name="id" value="20321"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20321</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0321'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0331" author="tprotopapas">

        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="courseValue" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0331" />
            <column name="rule_id" value="20331"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="courseValue != null &amp;&amp; !hasValidCourseValue(courseValue)"/>
            <column name="failure_message" value="Invalid course value."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20331"/>
            <column name="id" value="20331"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20331</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0331'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0311" author="tprotopapas">
        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="creationDateTimeString" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0311" />
            <column name="rule_id" value="20311"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="creationDateTimeString != null &amp;&amp; !hasValidCreationDateTime(creationDateTimeString)"/>
            <column name="failure_message" value="Occurrence date/time must be a valid UTC date/time in the correct format."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20311"/>
            <column name="id" value="20311"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20311</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0311'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0401" author="tprotopapas">
        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="latitudeMeasure" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0401" />
            <column name="rule_id" value="20401"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="latitudeMeasure != null &amp;&amp; !hasValidLatitudeMeasure(latitudeMeasure)"/>
            <column name="failure_message" value="Invalid latitude measure."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20401"/>
            <column name="id" value="20401"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20401</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0401'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="UNIONVMS-4660-update-VP-L01-00-0411" author="tprotopapas">
        <insert  tableName="rule">
            <column name="template_id" value="2004" />
            <column name="property_names" value="longitudeMeasure" />
            <column name="note" value="A threshold to compensate for incorrect clock synchronization of the exchanging systems must be taken into account." />
            <column name="level" value="L01" />
            <column name="error_type" value="ERROR" />
            <column name="disabled" value="false" />
            <column name="br_id" value="VP-L01-00-0411" />
            <column name="rule_id" value="20411"/>
        </insert >
        <insert  tableName="context_expression">
            <column name="expression" value="longitudeMeasure != null &amp;&amp; !hasValidLongitudeMeasure(longitudeMeasure)"/>
            <column name="failure_message" value="Invalid longitude measure."/>
            <column name="context" value="EU"/>
            <column name="rule_id" value="20411"/>
            <column name="id" value="20411"/>
        </insert >

        <rollback>
            <delete tableName="context_expression">
                <where>rule_id = 20411</where>
            </delete>
            <delete tableName="rule">
                <where>br_id = 'VP-L01-00-0411'</where>
            </delete>
        </rollback>
    </changeSet>

</databaseChangeLog>
