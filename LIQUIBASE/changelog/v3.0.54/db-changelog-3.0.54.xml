<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.3.xsd http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <!--
        This changeSet :
                            1. Creates the 'context_expression' P
                            2. Populates it with the data derived from actual 'rule' table
                            3. Drops the not needed anymore 'expression' and 'message' columns from 'rule' table
    -->

    <changeSet author="kovian" id="create-context_expression-table">

        <createTable tableName="context_expression">
            <column name="id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="context_expression_pk"/>
            </column>
            <column name="rule_id" type="BIGINT"/>
            <column name="context" type="text"/>
            <column name="expression" type="text"/>
            <column name="failure_message" type="text"/>
        </createTable>

        <addForeignKeyConstraint baseColumnNames="rule_id" baseTableName="context_expression"
                                 constraintName="rules_fc_fk" deferrable="false"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"
                                 referencedColumnNames="rule_id" referencedTableName="rule"/>

        <addUniqueConstraint columnNames="rule_id, context" tableName="context_expression"/>

        <delete tableName="rule">
            <where>BR_ID = 'FA-L02-00-0045'</where>
        </delete>

    </changeSet>

    <changeSet author="kovian" id="drop-columns-from-rule-table">
        <dropColumn tableName="rule" columnName="expression"/>
        <dropColumn tableName="rule" columnName="message"/>
    </changeSet>

    <changeSet author="kovian" id="insert-initial-data-for-context_expression-table">

        <!-- Insert data here -->

        <insert tableName="context_expression">
            <column name="id" value="1"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(ids)"/>
            <column name="rule_id" value="1"/>
            <column name="failure_message" value="Message ID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="2"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isEmpty(ids) &amp;&amp; schemeIdContainsAll(ids, &quot;UUID&quot;)"/>
            <column name="rule_id" value="2"/>
            <column name="failure_message" value="Message ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="3"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; mdrService.validateFormat(ids, creationDateOfMessage)"/>
            <column name="rule_id" value="3"/>
            <column name="failure_message" value="Message ID value not according to schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="4"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isEmpty(nonUniqueIdsList) &amp;&amp; containsAny(ids, nonUniqueIdsList)"/>
            <column name="rule_id" value="4"/>
            <column name="failure_message" value="Message ID already exists."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="5"/>
            <column name="context" value="EU"/>
            <column name="expression" value="creationDateTime == null"/>
            <column name="rule_id" value="5"/>
            <column name="failure_message" value="Message creation date/time missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="6"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(creationDateTimeString) &amp;&amp; !isIsoDateStringValidFormat(creationDateTimeString)"/>
            <column name="rule_id" value="6"/>
            <column name="failure_message" value="Invalid message creation date/time."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="7"/>
            <column name="context" value="EU"/>
            <column name="expression" value="creationDateTime != null &amp;&amp; dateNotInPast(creationDateTime, 10)"/>
            <column name="rule_id" value="7"/>
            <column name="failure_message" value="Message creation date/time not in the past."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="8"/>
            <column name="context" value="EU"/>
            <column name="expression" value="purposeCode == null"/>
            <column name="rule_id" value="8"/>
            <column name="failure_message" value="PurposeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="9"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="purposeCode != null &amp;&amp; listIdContainsAll(purposeCode, &quot;FLUX_GP_PURPOSE&quot;)"/>
            <column name="rule_id" value="9"/>
            <column name="failure_message" value="PurposeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10"/>
            <column name="context" value="EU"/>
            <column name="expression" value="purposeCode != null &amp;&amp; purposeCode.value != 9"/>
            <column name="rule_id" value="10"/>
            <column name="failure_message" value="PurposeCode has an invalid value."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="14"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(ownerFluxPartyIds)"/>
            <column name="rule_id" value="14"/>
            <column name="failure_message" value="Message Owner ID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="15"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ownerFluxPartyIds) &amp;&amp; schemeIdContainsAll(ownerFluxPartyIds, &quot;FLUX_GP_PARTY&quot;)"/>
            <column name="rule_id" value="15"/>
            <column name="failure_message" value="Message Owner ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="17"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(faReportDocuments)"/>
            <column name="rule_id" value="17"/>
            <column name="failure_message" value="At least one report must be present in the message."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="20"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="purposeCode != null &amp;&amp; typeCode == null &amp;&amp; (purposeCode.value == &quot;9&quot; || purposeCode.value == &quot;5&quot;)"/>
            <column name="rule_id" value="20"/>
            <column name="failure_message" value="Report type must be present for new reports or corrections."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="21"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; listIdContainsAll(typeCode, &quot;FLUX_FA_REPORT_TYPE&quot;)"/>
            <column name="rule_id" value="21"/>
            <column name="failure_message" value="Report type has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="22"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listId, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="22"/>
            <column name="failure_message" value="Invalid code for Report type."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="23"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedReportIDs) &amp;&amp; isAllSchemeIdsPresent(relatedReportIDs)"/>
            <column name="rule_id" value="23"/>
            <column name="failure_message" value="SchemeID not provided for Related report ID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="24"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedReportIDs) &amp;&amp; mdrService.validateFormat(relatedReportIDs, creationDateOfMessage)"/>
            <column name="rule_id" value="24"/>
            <column name="failure_message" value="Related report ID value not according to schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="25"/>
            <column name="context" value="EU"/>
            <column name="expression" value="acceptanceDateTime == null"/>
            <column name="rule_id" value="25"/>
            <column name="failure_message" value="Acceptance date/time missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="26"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(acceptanceDateTimeString) &amp;&amp; !isIsoDateStringValidFormat(acceptanceDateTimeString)"/>
            <column name="rule_id" value="26"/>
            <column name="failure_message" value="Invalid acceptance date/time."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="27"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="acceptanceDateTime != null &amp;&amp; dateNotInPast(acceptanceDateTime, 10)"/>
            <column name="rule_id" value="27"/>
            <column name="failure_message" value="Acceptance date/time not in the past."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="28"/>
            <column name="context" value="EU"/>
            <column name="expression" value="relatedFLUXReportDocument == null"/>
            <column name="rule_id" value="28"/>
            <column name="failure_message" value="Report details missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="29"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isEmpty(ids) &amp;&amp; schemeIdContainsAll(ids, &quot;UUID&quot;)"/>
            <column name="rule_id" value="29"/>
            <column name="failure_message" value="Report ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="30"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; mdrService.validateFormat(ids, creationDateOfMessage)"/>
            <column name="rule_id" value="30"/>
            <column name="failure_message" value="Report ID value not according to schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="32"/>
            <column name="context" value="EU"/>
            <column name="expression" value="purposeCode == null"/>
            <column name="rule_id" value="32"/>
            <column name="failure_message" value="PurposeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="33"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="purposeCode != null &amp;&amp; listIdContainsAll(purposeCode, &quot;FLUX_GP_PURPOSE&quot;)"/>
            <column name="rule_id" value="33"/>
            <column name="failure_message" value="PurposeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="34"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="purposeCode != null &amp;&amp; !mdrService.isPresentInMDRList(purposeCode.listId, purposeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="34"/>
            <column name="failure_message" value="PurposeCode has an invalid value."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="91"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode != null &amp;&amp; typeCode.listId != &quot;FLUX_FA_TYPE&quot;"/>
            <column name="rule_id" value="91"/>
            <column name="failure_message" value="Fishing activity TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="12"/>
            <column name="context" value="EU"/>
            <column name="expression" value="mdrService.validateFormat(referencedID, creationDateOfMessage)"/>
            <column name="rule_id" value="12"/>
            <column name="failure_message" value="Referenced Message ID value not according to schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="13"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="referencedID != null &amp;&amp; referencedID.schemeId == &quot;UUID&quot; &amp;&amp; !mdrService.validateFormat(referencedID, creationDateOfMessage) &amp;&amp; isEmpty(relatedFaQueryIDs)"/>
            <column name="rule_id" value="13"/>
            <column name="failure_message" value="The identification must exist for a FLUXFAQueryMessage"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="referencedID != null &amp;&amp; referencedID.schemeId != &quot;UUID&quot;"/>
            <column name="rule_id" value="11"/>
            <column name="failure_message" value="Referenced Message ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="16"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ownerFluxPartyIds) &amp;&amp; !matchWithFluxTL(ownerFluxPartyIds)"/>
            <column name="rule_id" value="16"/>
            <column name="failure_message" value="Message Owner ID not consistent with FLUX TL envelope parameters."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="35"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="purposeCode != null &amp;&amp; (purposeCode.value == &quot;1&quot; || purposeCode.value == &quot;3&quot; || purposeCode.value == &quot;5&quot;) &amp;&amp; (referencedID == null || (referencedID != null &amp;&amp; isEmpty(referencedID.value)))"/>
            <column name="rule_id" value="35"/>
            <column name="failure_message" value="Referenced Report ID missing. PurposeCode = 1, 3 or 5."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="39"/>
            <column name="context" value="EU"/>
            <column name="expression" value="creationDateTime == null"/>
            <column name="rule_id" value="39"/>
            <column name="failure_message" value="Report creation date/time missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="40"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isIsoDateStringValidFormat(creationDateTimeString)"/>
            <column name="rule_id" value="40"/>
            <column name="failure_message" value="Invalid report creation date/time."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="41"/>
            <column name="context" value="EU"/>
            <column name="expression" value="creationDateTime != null &amp;&amp; dateNotInPast(creationDateTime, 10)"/>
            <column name="rule_id" value="41"/>
            <column name="failure_message" value="Report creation date/time not in the past."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="42"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="creationDateTime != null &amp;&amp; acceptanceDateTime != null &amp;&amp; !acceptanceDateNotBeforeCreationDate(creationDateTime, acceptanceDateTime, -10)"/>
            <column name="rule_id" value="42"/>
            <column name="failure_message" value="Acceptance date/time not before report creation date/time."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="43"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(ownerFluxPartyIds)"/>
            <column name="rule_id" value="43"/>
            <column name="failure_message" value="Report Owner ID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="44"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ownerFluxPartyIds) &amp;&amp; schemeIdContainsAll(ownerFluxPartyIds, &quot;FLUX_GP_PARTY&quot;) "/>
            <column name="rule_id" value="44"/>
            <column name="failure_message" value="Report Owner ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="46"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="purposeCode != null &amp;&amp; (purposeCode.value == &quot;5&quot; || purposeCode.value == &quot;9&quot;) &amp;&amp; specifiedVesselTransportMeans == null"/>
            <column name="rule_id" value="46"/>
            <column name="failure_message" value="Reporting vessel information missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="47"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="purposeCode != null &amp;&amp; (purposeCode.value == &quot;5&quot; || purposeCode.value == &quot;9&quot;) &amp;&amp; !isValid(specifiedFishingActivities)"/>
            <column name="rule_id" value="47"/>
            <column name="failure_message" value="Fishing activity information missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="50"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(ids)"/>
            <column name="rule_id" value="50"/>
            <column name="failure_message" value="No vessel ID provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="51"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isFromFaReport &amp;&amp; !isEmpty(ids) &amp;&amp; !mdrService.isAllSchemeIdsPresentInMDRList(&quot;FLUX_VESSEL_ID_TYPE&quot;, ids, creationDateOfMessage)"/>
            <column name="rule_id" value="51"/>
            <column name="failure_message" value="Vessel ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="52"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="id != null &amp;&amp; mdrService.validateFormat(id, creationDateOfMessage)"/>
            <column name="rule_id" value="52"/>
            <column name="failure_message" value="Vessel ID value not according to schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="54"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; schemeIdContainsAny(ids, &quot;IRCS&quot;, &quot;CFR&quot;)"/>
            <column name="rule_id" value="54"/>
            <column name="failure_message" value="Both CFR and IRCS missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="55"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isFromFaReport &amp;&amp; roleCode == null"/>
            <column name="rule_id" value="55"/>
            <column name="failure_message" value="Role of the related vessel missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="56"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="roleCode != null &amp;&amp; roleCode.listId != &quot;FA_VESSEL_ROLE&quot;"/>
            <column name="rule_id" value="56"/>
            <column name="failure_message" value="RoleCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="57"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="roleCode != null &amp;&amp; !mdrService.isPresentInMDRList(roleCode.listId, roleCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="57"/>
            <column name="failure_message" value="RoleCode has an invalid value."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="59"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="registrationVesselCountryId != null &amp;&amp; (registrationVesselCountryId.schemeId != &quot;TERRITORY&quot;)"/>
            <column name="rule_id" value="59"/>
            <column name="failure_message" value="Invalid schemeID for country of registration."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="60"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="registrationVesselCountryId != null &amp;&amp;                                              !mdrService.isPresentInMDRList(registrationVesselCountryId.schemeId, registrationVesselCountryId.value, creationDateOfMessage)"/>
            <column name="rule_id" value="60"/>
            <column name="failure_message" value="Invalid value for country of registration."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="61"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; registrationVesselCountryId != null &amp;&amp;                 ((mdrService.isPresentInMDRList(&quot;MEMBER_STATE&quot;, registrationVesselCountryId.value, creationDateOfMessage) &amp;&amp; !containsAtLeastOneCorrectIdOfTheRequired(&quot;CFR&quot;))                 || (!mdrService.isPresentInMDRList(&quot;MEMBER_STATE&quot;, registrationVesselCountryId.value, creationDateOfMessage)                 &amp;&amp; (!containsAtLeastOneCorrectIdOfTheRequired(&quot;IRCS&quot;) || !containsAtLeastOneCorrectIdOfTheRequired(&quot;EXT_MARK&quot;))))"/>
            <column name="rule_id" value="61"/>
            <column name="failure_message" value="Invalid value for country of registration."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="266"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!subActivity &amp;&amp;  isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="266"/>
            <column name="failure_message" value="Location missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="37"/>
            <column name="context" value="EU"/>
            <column name="expression" value="mdrService.validateFormat(referencedID, creationDateOfMessage)"/>
            <column name="rule_id" value="37"/>
            <column name="failure_message" value="Referenced Report ID value not according to schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="36"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="referencedID != null &amp;&amp; referencedID.schemeId != &quot;UUID&quot;"/>
            <column name="rule_id" value="36"/>
            <column name="failure_message" value="Referenced Report ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="45"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ownerFluxPartyIds) &amp;&amp; idTypeValueContainsAny(ownerFluxPartyIds, &quot;XEU&quot;, &quot;XFA&quot;) &amp;&amp; !matchWithFluxTL(ownerFluxPartyIds)"/>
            <column name="rule_id" value="45"/>
            <column name="failure_message" value="Report Owner ID not consistent with FLUX TL envelope parameters."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="58"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="registrationVesselCountryId == null || (registrationVesselCountryId != null &amp;&amp; isEmpty(registrationVesselCountryId.value))"/>
            <column name="rule_id" value="58"/>
            <column name="failure_message" value="Country of registration missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="62"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="registrationVesselCountryId != null &amp;&amp; transportMeans != null &amp;&amp; (transportMeans.asset == null  || (transportMeans.asset != null &amp;&amp; isEmpty(transportMeans.asset.countryCode)) || transportMeans.asset.countryCode != registrationVesselCountryId.value)"/>
            <column name="rule_id" value="62"/>
            <column name="failure_message" value="Inconsistent information of vessel ID and registration country."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="64"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; !schemeIdContainsAll(ids, &quot;CFR&quot;) &amp;&amp; transportMeans != null  &amp;&amp; transportMeans.asset == null"/>
            <column name="rule_id" value="64"/>
            <column name="failure_message" value="Vessel ID CFR is provided but the vessel is not registered in EU."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="65"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; !schemeIdContainsAll(ids, &quot;ICCAT&quot;) &amp;&amp; transportMeans != null  &amp;&amp; transportMeans.asset == null"/>
            <column name="rule_id" value="65"/>
            <column name="failure_message"
                    value="Vessel ID ICCAT is provided but the vessel is not registered in the ICCAT register."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="66"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; !schemeIdContainsAll(ids, &quot;IRCS&quot;, &quot;EXT_MARK&quot;) &amp;&amp; schemeIdContainsAll(ids, &quot;CFR&quot;) &amp;&amp; transportMeans != null  &amp;&amp; transportMeans.asset == null"/>
            <column name="rule_id" value="66"/>
            <column name="failure_message"
                    value="Vessel ID IRCS and external marking are provided, but the vessel is not registered on a list non-EU vessels."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="67"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isFromFaReport &amp;&amp; isEmpty(specifiedContactParties)"/>
            <column name="rule_id" value="67"/>
            <column name="failure_message" value="Contact details of the reporting vessel are missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="68"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="roleCode != null &amp;&amp; roleCode.value == &quot;PAIR_FISHING_PARTNER&quot; &amp;&amp; isEmpty(specifiedContactParties)"/>
            <column name="rule_id" value="68"/>
            <column name="failure_message" value="Contact details are missing for the pair fishing partner."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="69"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedContactPartyRoleCodes) &amp;&amp; listIdContainsAll(specifiedContactPartyRoleCodes, &quot;FLUX_CONTACT_ROLE&quot;)"/>
            <column name="rule_id" value="69"/>
            <column name="failure_message" value="Contact RoleCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="70"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedContactPartyRoleCodes) &amp;&amp;                                              !mdrService.isCodeTypePresentInMDRList(&quot;FLUX_CONTACT_ROLE&quot;, specifiedContactPartyRoleCodes, creationDateOfMessage)"/>
            <column name="rule_id" value="70"/>
            <column name="failure_message" value="Contact RoleCode has an invalid value."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="76"/>
            <column name="context" value="EU"/>
            <column name="expression" value="checkAliasFromContactList(specifiedContactPersons, false)"/>
            <column name="rule_id" value="76"/>
            <column name="failure_message" value="Contact alias missing as either given or family name are missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="77"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedContactPersons) &amp;&amp; checkAliasFromContactList(specifiedContactPersons, true)"/>
            <column name="rule_id" value="77"/>
            <column name="failure_message" value="The contact alias cannot be empty."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="78"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isFromFaReport &amp;&amp; isEmpty(specifiedStructuredAddresses)"/>
            <column name="rule_id" value="78"/>
            <column name="failure_message" value="Contact address details missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="80"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(postOfficeBox) &amp;&amp; streetName == null"/>
            <column name="rule_id" value="80"/>
            <column name="failure_message" value="Streetname missing"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="81"/>
            <column name="context" value="EU"/>
            <column name="expression" value="streetName != null &amp;&amp; isEmpty(streetName)"/>
            <column name="rule_id" value="81"/>
            <column name="failure_message" value="Streetname cannot be empty."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="82"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="countryID != null &amp;&amp; countryID.value != null &amp;&amp; countryID.value != &quot;IRL&quot; &amp;&amp; postalArea == null"/>
            <column name="rule_id" value="82"/>
            <column name="failure_message" value="Postal area information missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="83"/>
            <column name="context" value="EU"/>
            <column name="expression" value="postalArea != null &amp;&amp; isEmpty(postalArea)"/>
            <column name="rule_id" value="83"/>
            <column name="failure_message" value="Postal area provided cannot be empty."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="84"/>
            <column name="context" value="EU"/>
            <column name="expression" value="cityName == null"/>
            <column name="rule_id" value="84"/>
            <column name="failure_message" value="City name missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="85"/>
            <column name="context" value="EU"/>
            <column name="expression" value="cityName != null &amp;&amp; isEmpty(cityName)"/>
            <column name="rule_id" value="85"/>
            <column name="failure_message" value="City name provided cannot be empty."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="86"/>
            <column name="context" value="EU"/>
            <column name="expression" value="countryID == null"/>
            <column name="rule_id" value="86"/>
            <column name="failure_message" value="Country ID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="87"/>
            <column name="context" value="EU"/>
            <column name="expression" value="countryID != null &amp;&amp; countryID.schemeId != &quot;TERRITORY&quot;"/>
            <column name="rule_id" value="87"/>
            <column name="failure_message" value="Country ID has invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="88"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="countryID != null &amp;&amp; countryID.schemeId != null &amp;&amp; countryID.value != null &amp;&amp; !mdrService.isPresentInMDRList(countryID.schemeId, countryID.value, creationDateOfMessage)"/>
            <column name="rule_id" value="88"/>
            <column name="failure_message" value="Country ID value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="89"/>
            <column name="context" value="EU"/>
            <column name="expression" value="plotIdentification == null"/>
            <column name="rule_id" value="89"/>
            <column name="failure_message" value="House number missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="90"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null || isEmpty(typeCode.value)"/>
            <column name="rule_id" value="90"/>
            <column name="failure_message" value="Fishing activity TypeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="72"/>
            <column name="context" value="EU"/>
            <column name="expression" value="checkContactListContainsAny(specifiedContactPersons, true, true)"/>
            <column name="rule_id" value="72"/>
            <column name="failure_message" value="Given name of the contact missing as no contact alias is provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="71"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isFromFaReport &amp;&amp; !isEmpty(specifiedContactPartyRoleCodes) &amp;&amp;                            !codeTypeValueContainsMatch(specifiedContactPartyRoleCodes, &quot;MASTER&quot;, &quot;AGENT&quot;)"/>
            <column name="rule_id" value="71"/>
            <column name="failure_message" value="Invalid Contact RoleCode provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="92"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listId, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="92"/>
            <column name="failure_message" value="Fishing activity TypeCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="93"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="subActivity &amp;&amp; typeCode != null &amp;&amp;                                              valueContainsAny(typeCode,&quot;GEAR_SHOT&quot;,&quot;GEAR_RETRIEVAL&quot;,&quot;RELOCATION&quot;,&quot;START_ACTIVITY&quot;)"/>
            <column name="rule_id" value="93"/>
            <column name="failure_message" value="Invalid fishing activity TypeCode for this sub-activity."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="94"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; occurrenceDateTime != null &amp;&amp; !isValid(occurrenceDateTime)"/>
            <column name="rule_id" value="94"/>
            <column name="failure_message" value="Invalid occurrence date/time of the activity."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="95"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!subActivity &amp;&amp; !validDates()"/>
            <column name="rule_id" value="95"/>
            <column name="failure_message"
                    value="The activity or the sub-activity must have an occurrence date/time or a delimited period."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="96"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; isEmpty(relatedFLUXLocations) &amp;&amp; (relatedActivityFluxLocations == null || relatedActivityFluxLocations.empty == true)"/>
            <column name="rule_id" value="96"/>
            <column name="failure_message" value="The activity or sub-activity must have a location."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="97"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="reasonCode != null &amp;&amp; !mdrService.isPresentInMDRList(reasonCode.listId, reasonCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="97"/>
            <column name="failure_message" value="ReasonCode value invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="98"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="fisheryTypeCode != null &amp;&amp; fisheryTypeCode.listId != &quot;FA_FISHERY&quot;"/>
            <column name="rule_id" value="98"/>
            <column name="failure_message" value="FisheryTypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="99"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="fisheryTypeCode != null &amp;&amp; !mdrService.isPresentInMDRList(fisheryTypeCode.listId, fisheryTypeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="99"/>
            <column name="failure_message" value="FisheryTypeCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="100"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="speciesTargetCode != null &amp;&amp; (speciesTargetCode.listId != &quot;FAO_SPECIES&quot; &amp;&amp; speciesTargetCode.listId != &quot;TARGET_SPECIES_GROUP&quot;)"/>
            <column name="rule_id" value="100"/>
            <column name="failure_message" value="Target species code has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="101"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="speciesTargetCode != null &amp;&amp; !mdrService.isPresentInMDRList(speciesTargetCode.listId, speciesTargetCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="101"/>
            <column name="failure_message" value="Invalid Target species."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="102"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="vesselRelatedActivityCode != null &amp;&amp; vesselRelatedActivityCode.listId != &quot;VESSEL_ACTIVITY&quot;"/>
            <column name="rule_id" value="102"/>
            <column name="failure_message" value="Vessel activity has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="103"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="vesselRelatedActivityCode != null &amp;&amp; !mdrService.isPresentInMDRList(vesselRelatedActivityCode.listId, vesselRelatedActivityCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="103"/>
            <column name="failure_message" value="Invalid vessel activity."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="104"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="operationQuantity != null  &amp;&amp; !isPositiveIntegerValue(operationQuantity)"/>
            <column name="rule_id" value="104"/>
            <column name="failure_message" value="Not a positive integer."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="105"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isEmpty(durationMeasure) &amp;&amp; !isPositive(durationMeasure)"/>
            <column name="rule_id" value="105"/>
            <column name="failure_message" value="Not a positive number."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="106"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(durationMeasure) &amp;&amp; unitCodeContainsAll(durationMeasure, &quot;MIN&quot;)"/>
            <column name="rule_id" value="106"/>
            <column name="failure_message" value="Unit must be minutes."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="111"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!subActivity &amp;&amp; specifiedFishingTrip == null"/>
            <column name="rule_id" value="111"/>
            <column name="failure_message" value="Fishing trip details missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="112"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isAllowedToHaveSubactivities()"/>
            <column name="rule_id" value="112"/>
            <column name="failure_message" value="Sub-activity information not allowed for this type of activity."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="113"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(fluxCharacteristicsTypeCode) &amp;&amp; listIdContainsAll(fluxCharacteristicsTypeCode, &quot;FA_CHARACTERISTIC&quot;)"/>
            <column name="rule_id" value="113"/>
            <column name="failure_message" value="Characteristics TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="120"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; listIdNotContains(typeCode, &quot;GEAR_TYPE&quot;)"/>
            <column name="rule_id" value="120"/>
            <column name="failure_message" value="Fishing gear TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="121"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;GEAR_TYPE&quot;, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="121"/>
            <column name="failure_message" value="Fishing gear TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="122"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(roleCodes) &amp;&amp; listIdNotContains(roleCodes, &quot;FA_GEAR_ROLE&quot;)"/>
            <column name="rule_id" value="122"/>
            <column name="failure_message" value="Fishing gear RoleCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="123"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="fishingActivity &amp;&amp; fishingGear != null &amp;&amp; !valid(fishingGear)"/>
            <column name="rule_id" value="123"/>
            <column name="failure_message" value="ApplicableGearCharacteristic missing"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="134"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(roleCodes) &amp;&amp; !mdrService.isCodeTypePresentInMDRList(roleCodes, creationDateOfMessage)"/>
            <column name="rule_id" value="134"/>
            <column name="failure_message" value="Fishing gear role codes do not exist in list."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="124"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="124"/>
            <column name="failure_message" value="GearCharacteristic TypeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="125"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; listIdContainsAll(typeCode, &quot;FA_GEAR_CHARACTERISTIC&quot;)"/>
            <column name="rule_id" value="125"/>
            <column name="failure_message" value="GearCharacteristic TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="126"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;FA_GEAR_CHARACTERISTIC&quot;, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="126"/>
            <column name="failure_message" value="GearCharacteristic TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="130"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_GEAR_CHARACTERISTIC&quot; , typeCode.value) == &quot;CODE&quot; &amp;&amp; isBlank(valueCode)"/>
            <column name="rule_id" value="130"/>
            <column name="failure_message" value="Expected code value missing. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="131"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value !=null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_GEAR_CHARACTERISTIC&quot;, typeCode.value) == &quot;TEXT&quot; &amp;&amp; isBlank(value)"/>
            <column name="rule_id" value="131"/>
            <column name="failure_message" value="Expected text value missing. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="132"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_GEAR_CHARACTERISTIC&quot; , typeCode.value) == &quot;QUANTITY&quot; &amp;&amp; isBlank(valueQuantity)"/>
            <column name="rule_id" value="132"/>
            <column name="failure_message" value="Expected quantity value missing. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="133"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueMeasure != null &amp;&amp;  !mdrService.isPresentInMDRList(&quot;FLUX_UNIT&quot;, valueMeasure.unitCode, creationDateOfMessage) "/>
            <column name="rule_id" value="133"/>
            <column name="failure_message" value="Unexpected unit code for Measure."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="135"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="135"/>
            <column name="failure_message" value="Gear problem TypeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="136"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; listIdNotContains(typeCode, &quot;FA_GEAR_PROBLEM&quot;)"/>
            <column name="rule_id" value="136"/>
            <column name="failure_message" value="Gear problem TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="137"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;FA_GEAR_PROBLEM&quot;, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="137"/>
            <column name="failure_message" value="The value of gear problem TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="138"/>
            <column name="context" value="EU"/>
            <column name="expression" value="affectedQuantity == null"/>
            <column name="rule_id" value="138"/>
            <column name="failure_message" value="Affected quantity of gear missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="140"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(recoveryMeasureCodes)"/>
            <column name="rule_id" value="140"/>
            <column name="failure_message" value="Recovery measure missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="141"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(recoveryMeasureCodes) &amp;&amp; listIdNotContains(recoveryMeasureCodes, &quot;FA_GEAR_RECOVERY&quot;)"/>
            <column name="rule_id" value="141"/>
            <column name="failure_message" value="Recovery measure has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="142"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(recoveryMeasureCodes) &amp;&amp; !mdrService.isCodeTypePresentInMDRList(&quot;FA_GEAR_RECOVERY&quot;, recoveryMeasureCodes, creationDateOfMessage)"/>
            <column name="rule_id" value="142"/>
            <column name="failure_message" value="Recovery measure value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="143"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedFluxLocations)"/>
            <column name="rule_id" value="143"/>
            <column name="failure_message" value="Location for the gear problem is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="144"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFluxLocations) &amp;&amp; !anyFluxLocationTypeCodeContainsValue(specifiedFluxLocations,&quot;POSITION&quot;)"/>
            <column name="rule_id" value="144"/>
            <column name="failure_message" value="Invalid type of location provided for this gear problem."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="150"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="150"/>
            <column name="failure_message" value="TypeCode for this catch is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="151"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.listId != null &amp;&amp; typeCode.listId != &quot;FA_CATCH_TYPE&quot;"/>
            <column name="rule_id" value="151"/>
            <column name="failure_message" value="TypeCode for this catch has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="152"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.listId != null &amp;&amp; typeCode.value != null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listId, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="152"/>
            <column name="failure_message"
                    value="Check code. Must be existing in the list specified in attribute listID "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="153"/>
            <column name="context" value="EU"/>
            <column name="expression" value="speciesCode == null"/>
            <column name="rule_id" value="153"/>
            <column name="failure_message" value="Species code missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="154"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="speciesCode != null &amp;&amp; speciesCode.listId != null &amp;&amp; speciesCode.listId != &quot;FAO_SPECIES&quot;"/>
            <column name="rule_id" value="154"/>
            <column name="failure_message" value="Species code has an invalid listID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="155"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="speciesCode != null &amp;&amp; speciesCode.listId != null &amp;&amp; speciesCode.value != null &amp;&amp; !mdrService.isPresentInMDRList(speciesCode.listId, speciesCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="155"/>
            <column name="failure_message"
                    value="Check code. Must be existing in the list specified in attribute listID "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="156"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="unitQuantity == null &amp;&amp; (weightMeasure == null  &amp;&amp; isEmpty(resultAAPProductWeightMeasure))"/>
            <column name="rule_id" value="156"/>
            <column name="failure_message"
                    value="Units (number of fish) must be present if neither live weight nor product weight are present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="158"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="unitQuantity != null &amp;&amp; unitQuantity.value != null &amp;&amp; !isPositiveIntegerValue(unitQuantity.value)"/>
            <column name="rule_id" value="158"/>
            <column name="failure_message" value="Units (number of fish) must be a positive integer."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="160"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="weightMeasure != null &amp;&amp; weightMeasure.unitCode != null &amp;&amp; weightMeasure.unitCode != &quot;KGM&quot;"/>
            <column name="rule_id" value="160"/>
            <column name="failure_message" value="Unit of weight for this catch must be expressed in kilograms."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10024"/>
            <column name="context" value="EU"/>
            <column name="expression" value="specifiedSizeDistribution == null"/>
            <column name="rule_id" value="10024"/>
            <column name="failure_message" value="Size Distribution in AAPProduct must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="129"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_GEAR_CHARACTERISTIC&quot;, typeCode.value) == &quot;BOOLEAN&quot; &amp;&amp; valueIndicator == null "/>
            <column name="rule_id" value="129"/>
            <column name="failure_message" value="Expected indicator type missing. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="163"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="weighingMeansCode != null &amp;&amp; listIdContainsAll(weighingMeansCode, &quot;WEIGHT_MEANS&quot;)"/>
            <column name="rule_id" value="163"/>
            <column name="failure_message" value="FA_Catch Weighing_MeansCode attribute listID must be WEIGHT_MEANS."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="164"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="weighingMeansCode != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;WEIGHT_MEANS&quot; ,weighingMeansCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="164"/>
            <column name="failure_message"
                    value="FA_Catch Weighing_MeansCode code must be present in MDR codelist WEIGHT_MEANS."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="165"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!((subActivity &amp;&amp; fishingActivityTypeCode != null &amp;&amp; fishingActivityTypeCode.value == &quot;RELOCATION&quot;) || (!subActivity &amp;&amp; fishingActivityTypeCode != null &amp;&amp; (fishingActivityTypeCode.value == &quot;AREA_ENTRY&quot; || fishingActivityTypeCode.value == &quot;AREA_EXIT&quot;))) &amp;&amp; isEmpty(sizeDistributionClassCode)"/>
            <column name="rule_id" value="165"/>
            <column name="failure_message" value="Size distribution information missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="166"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(sizeDistributionClassCode) &amp;&amp; listIdContainsAll(sizeDistributionClassCode, &quot;FISH_SIZE_CLASS&quot;)"/>
            <column name="rule_id" value="166"/>
            <column name="failure_message" value="The ClassCode listID is not valid for this size distribution."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="167"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(sizeDistributionClassCode) &amp;&amp; !mdrService.isCodeTypePresentInMDRList(&quot;FISH_SIZE_CLASS&quot;, sizeDistributionClassCode, creationDateOfMessage)"/>
            <column name="rule_id" value="167"/>
            <column name="failure_message" value="The size distribution ClassCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="169"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="categoryCode != null &amp;&amp; listIdContainsAll(categoryCode, &quot;FA_BFT_SIZE_CATEGORY&quot;)"/>
            <column name="rule_id" value="169"/>
            <column name="failure_message"
                    value="Specified Size_Distribution CategoryCode attribute listID must be FA_BFT_SIZE_CATEGORY"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="170"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="categoryCode != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;FA_BFT_SIZE_CATEGORY&quot; , categoryCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="170"/>
            <column name="failure_message"
                    value="Specified Size_Distribution CategoryCode value must be present in FA_BFT_SIZE_CATEGORY list"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="411"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; isEmpty(unitQuantity) &amp;&amp; !codeTypeValueEquals(fishingActivityTypeCode, &quot;LANDING&quot;) &amp;&amp; !codeTypeValueEquals(fishingActivityTypeCode, &quot;TRANSHIPMENT&quot;) &amp;&amp; codeTypeValueEquals(speciesCode, &quot;SWO&quot;) &amp;&amp; !schemeIdContainsAny(fishActRelatedFluxLocationIds, &quot;GFCM_GSA&quot;) &amp;&amp; mdrService.isIdTypePresentInMDRList(&quot;GFCM_GSA&quot;,fishActRelatedFluxLocationIds, creationDateOfMessage) "/>
            <column name="rule_id" value="411"/>
            <column name="failure_message"
                    value="Units (number of fish) must be provided for Swordfish in GFCM. This rule only applies to catches related to the main fishing activity, not the related fishing activity."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="176"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(resultAAPProductPackagingTypeCode) &amp;&amp; listIdContainsAll(resultAAPProductPackagingTypeCode, &quot;FISH_PACKAGING&quot;)"/>
            <column name="rule_id" value="176"/>
            <column name="failure_message" value="Packaging TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="177"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(resultAAPProductPackagingTypeCode) &amp;&amp; !mdrService.isCodeTypePresentInMDRList(&quot;FISH_PACKAGING&quot; , resultAAPProductPackagingTypeCode, creationDateOfMessage)"/>
            <column name="rule_id" value="177"/>
            <column name="failure_message" value="The value of packaging TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="178"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(resultAAPProductPackagingUnitAverageWeightMeasure) &amp;&amp; unitCodeContainsAll(resultAAPProductPackagingUnitAverageWeightMeasure, &quot;KGM&quot;)"/>
            <column name="rule_id" value="178"/>
            <column name="failure_message" value="The average packaging unit weight must be expressed in kilograms."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="182"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(resultAAPProductWeightMeasure) &amp;&amp; unitCodeContainsAll(resultAAPProductWeightMeasure, &quot;KGM&quot;)"/>
            <column name="rule_id" value="182"/>
            <column name="failure_message" value="The product weight must be expressed in kilograms."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10048"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(originFLUXLocations)"/>
            <column name="rule_id" value="10048"/>
            <column name="failure_message" value="FLUX Location in AAPProduct must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="179"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(resultAAPProductPackagingUnitAverageWeightMeasure) &amp;&amp; !isStrictPositive(resultAAPProductPackagingUnitAverageWeightMeasure)"/>
            <column name="rule_id" value="179"/>
            <column name="failure_message" value="The average packaging unit weight must be a positive number."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="161"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="weightMeasure != null &amp;&amp; weightMeasure.value != null &amp;&amp; (isNegative(weightMeasure.value) || (getNumberOfDecimalPlaces(weightMeasure.value, true) &gt; 2))"/>
            <column name="rule_id" value="161"/>
            <column name="failure_message"
                    value="Not more than 2 decimals should be provided for the weight of this catch."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="189"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(appliedAAPProcess) &amp;&amp;                      (codeTypeValueEquals(fishingActivityTypeCode, &quot;LANDING&quot;) || codeTypeValueEquals(fishingActivityTypeCode, &quot;TRANSHIPMENT&quot;)) &amp;&amp;                      (codeTypeValueEquals(typeCode, &quot;UNLOADED&quot;) || codeTypeValueEquals(typeCode, &quot;LOADED&quot;))"/>
            <column name="rule_id" value="189"/>
            <column name="failure_message" value="Catch processing information missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="181"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(!isEmpty(resultAAPProduct) &amp;&amp; isEmpty(resultAAPProductWeightMeasure)) ||                     (!isEmpty(resultAAPProduct) &amp;&amp; !isEmpty(resultAAPProductWeightMeasure) &amp;&amp; resultAAPProduct.size() != resultAAPProductWeightMeasure.size())"/>
            <column name="rule_id" value="181"/>
            <column name="failure_message" value="Product weight missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="184"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!valueContainsAny(fishingActivityTypeCode, &quot;LANDING&quot;, &quot;TRANSHIPMENT&quot;) &amp;&amp; !valueContainsAny(speciesCode, &quot;SAL&quot;) &amp;&amp; !schemeIdContainsAll(faCatchFluxLocationId, &quot;FAO_AREA&quot;)
&amp;&amp; valueStartsWith(faCatchFluxLocationId,&quot;27.3.d&quot;) &amp;&amp; isEmpty(resultAAPProductUnitQuantity) "/>
            <column name="rule_id" value="184"/>
            <column name="failure_message"
                    value="Units (number of fish) must be provided for landings/transhipments of Salmon from the Baltic sea."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="186"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(resultAAPProductUnitQuantity) &amp;&amp;                           (codeTypeValueEquals(fishingActivityTypeCode, &quot;LANDING&quot;) || codeTypeValueEquals(fishingActivityTypeCode, &quot;TRANSHIPMENT&quot;)) &amp;&amp;                           codeTypeValueEquals(speciesCode, &quot;BFT&quot;) &amp;&amp; !schemeIdContainsAny(faCatchFluxLocationId, &quot;GFCM_GSA&quot;)"/>
            <column name="rule_id" value="186"/>
            <column name="failure_message"
                    value="Units (number of fish) must be provided for landings/transhipments of Bluefin tuna from GFCM area."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="190"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(ids)"/>
            <column name="rule_id" value="190"/>
            <column name="failure_message" value="Trip ID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="192"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; mdrService.validateSchemeIdFormat(ids, &quot;EU_TRIP_ID&quot;, creationDateOfMessage)"/>
            <column name="rule_id" value="192"/>
            <column name="failure_message"
                    value="Check format. Must be according to schemeID rules. For schemeID=EU_TRIP_ID: Starting with the ISO-3 code of the country, followed by a hyphen, followed by TRP, followed by a hyphen, followed by a unique string of at most 20 alphanumeric characters. The string can be formatted according to the following pattern [A- Za-z0-9-\/]{0,20} For other schemeIDs =&gt; ignore"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="193"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.listId != &quot;FISHING_TRIP_TYPE&quot;"/>
            <column name="rule_id" value="193"/>
            <column name="failure_message" value="Trip TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="194"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;FISHING_TRIP_TYPE&quot;, typeCode.value, creationDateOfMessage) "/>
            <column name="rule_id" value="194"/>
            <column name="failure_message" value="Trip ID TypeCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="195"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="195"/>
            <column name="failure_message" value="Location TypeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="196"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; listIdContainsAll(typeCode, &quot;FLUX_LOCATION_TYPE&quot;)"/>
            <column name="rule_id" value="196"/>
            <column name="failure_message" value="Location TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="197"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;FLUX_LOCATION_TYPE&quot;, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="197"/>
            <column name="failure_message" value="Location TypeCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="198"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !valueContainsAny(typeCode,&quot;LOCATION&quot;,&quot;ADDRESS&quot;) &amp;&amp; countryID == null"/>
            <column name="rule_id" value="198"/>
            <column name="failure_message" value="Location CountryID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="199"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="countryID != null &amp;&amp; schemeIdContainsAll(countryID, &quot;TERRITORY&quot;)"/>
            <column name="rule_id" value="199"/>
            <column name="failure_message" value="Location CountryID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="200"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="countryID != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;TERRITORY&quot;, countryID.value, creationDateOfMessage)"/>
            <column name="rule_id" value="200"/>
            <column name="failure_message" value="Location CountryID value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="201"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value != &quot;POSITION&quot; &amp;&amp; id == null"/>
            <column name="rule_id" value="201"/>
            <column name="failure_message" value="Location ID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="203"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="id != null &amp;&amp; id.schemeId != null &amp;&amp; !mdrService.isPresentInMDRList(id.schemeId, id.value, creationDateOfMessage)"/>
            <column name="rule_id" value="203"/>
            <column name="failure_message" value="Location ID value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="206"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value == &quot;POSITION&quot; &amp;&amp; specifiedPhysicalFLUXGeographicalCoordinate == null"/>
            <column name="rule_id" value="206"/>
            <column name="failure_message" value="Geographical coordinate missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="207"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedPhysicalFLUXGeographicalCoordinate != null &amp;&amp; specifiedPhysicalFLUXGeographicalCoordinate.latitudeMeasure == null"/>
            <column name="rule_id" value="207"/>
            <column name="failure_message" value="Latitude missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10027"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(classCodes)"/>
            <column name="rule_id" value="10027"/>
            <column name="failure_message" value="Class in SizeDistribution must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="185"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(resultAAPProductUnitQuantity) &amp;&amp; !isStrictPositive(resultAAPProductUnitQuantity)"/>
            <column name="rule_id" value="185"/>
            <column name="failure_message" value="Units (number of fish) must be positive integer number."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="209"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedPhysicalFLUXGeographicalCoordinate != null &amp;&amp; specifiedPhysicalFLUXGeographicalCoordinate.latitudeMeasure != null &amp;&amp; specifiedPhysicalFLUXGeographicalCoordinate.latitudeMeasure.value != null
                           &amp;&amp; (!isInRange(specifiedPhysicalFLUXGeographicalCoordinate.latitudeMeasure.value, -90, 90) || getNumberOfDecimalPlaces(specifiedPhysicalFLUXGeographicalCoordinate.latitudeMeasure.value, false) &lt; 1)"/>
            <column name="rule_id" value="209"/>
            <column name="failure_message" value="Invalid latitude value."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="210"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedPhysicalFLUXGeographicalCoordinate != null &amp;&amp; specifiedPhysicalFLUXGeographicalCoordinate.longitudeMeasure == null"/>
            <column name="rule_id" value="210"/>
            <column name="failure_message" value="Longitude missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="215"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value != null &amp;&amp; typeCode.value == &quot;ADDRESS&quot; &amp;&amp; physicalStructuredAddress == null"/>
            <column name="rule_id" value="215"/>
            <column name="failure_message" value="Structured address missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="216"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(applicableFLUXCharacteristicTypeCode) &amp;&amp; listIdContainsAll(applicableFLUXCharacteristicTypeCode, &quot;FLUX_LOCATION_CHARACTERISTIC&quot;) "/>
            <column name="rule_id" value="216"/>
            <column name="failure_message" value="FLUX characteristic has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="220"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="220"/>
            <column name="failure_message" value="FLUX characteristic TypeCode is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="221"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isTypeCodeValuePresentInList(typeCode.listId, typeCode, creationDateOfMessage)"/>
            <column name="rule_id" value="221"/>
            <column name="failure_message" value="The value of the FLUX characteristic TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="224"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_CHARACTERISTIC&quot;, typeCode.value) == &quot;DATETIME&quot; &amp;&amp; valueDateTime == null"/>
            <column name="rule_id" value="224"/>
            <column name="failure_message" value="Expected date/time type missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="226"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_CHARACTERISTIC&quot;, typeCode.value) == &quot;CODE&quot; &amp;&amp; (valueCode == null                     || valueCode != null  &amp;&amp; isEmpty(valueCode.value))"/>
            <column name="rule_id" value="226"/>
            <column name="failure_message" value="Expected code value missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="227"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_CHARACTERISTIC&quot;, typeCode.value) == &quot;TEXT&quot; &amp;&amp; isEmpty(values)"/>
            <column name="rule_id" value="227"/>
            <column name="failure_message" value="Expected text value missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="228"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_CHARACTERISTIC&quot;, typeCode.value) == &quot;QUANTITY&quot; &amp;&amp;                           (valueQuantity == null || valueQuantity.value == null)"/>
            <column name="rule_id" value="228"/>
            <column name="failure_message" value="Expected quantity value missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="230"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(typeCodes)"/>
            <column name="rule_id" value="230"/>
            <column name="failure_message" value="Vessel storage characteristics missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="231"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(typeCodes) &amp;&amp; listIdNotContains(typeCodes, &quot;VESSEL_STORAGE_TYPE&quot;)"/>
            <column name="rule_id" value="231"/>
            <column name="failure_message" value="Vessel storage characteristics TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="232"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(typeCodes) &amp;&amp; !mdrService.isTypeCodeValuePresentInList(&quot;VESSEL_STORAGE_TYPE&quot;, typeCodes, creationDateOfMessage)"/>
            <column name="rule_id" value="232"/>
            <column name="failure_message" value="The value of vessel storage characteristics TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="234"/>
            <column name="context" value="EU"/>
            <column name="expression" value="occurrenceDateTime == null"/>
            <column name="rule_id" value="234"/>
            <column name="failure_message" value="Occurrence date/time missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="236"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="236"/>
            <column name="failure_message" value="Departure location missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="237"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(relatedFLUXLocationTypeCodes) || valueContainsAny(relatedFLUXLocationTypeCodes, &quot;POSITION&quot;, &quot;LOCATION&quot; )"/>
            <column name="rule_id" value="237"/>
            <column name="failure_message"
                    value="If the activity is a departure declaration at least one RelatedFLUX Location/TypeCode must be LOCATION or POSITION "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="238"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFLUXLocationTypeCodes) &amp;&amp; !codeTypeValuesUnique(relatedFLUXLocationTypeCodes)"/>
            <column name="rule_id" value="238"/>
            <column name="failure_message" value="Location TypeCode value may only appear once."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="239"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedFishingGearsArePresent &amp;&amp; (isEmpty(specifiedFishingGearRoleCodeTypes) || !codeTypeValueContainsMatch(specifiedFishingGearRoleCodeTypes, &quot;ONBOARD&quot;))"/>
            <column name="rule_id" value="239"/>
            <column name="failure_message" value="Fishing gear Rolecode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="240"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFACatchCodeTypes) &amp;&amp; !codeTypeValueContainsMatch(specifiedFACatchCodeTypes, &quot;ONBOARD&quot;)"/>
            <column name="rule_id" value="240"/>
            <column name="failure_message" value="TypeCode of the catches is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="235"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="reasonCode != null &amp;&amp; listIdContainsAll(reasonCode, &quot;FA_REASON_DEPARTURE&quot;)"/>
            <column name="rule_id" value="235"/>
            <column name="failure_message" value="The listID for the reason for departure is not valid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="212"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedPhysicalFLUXGeographicalCoordinate != null &amp;&amp; specifiedPhysicalFLUXGeographicalCoordinate.longitudeMeasure != null &amp;&amp; specifiedPhysicalFLUXGeographicalCoordinate.longitudeMeasure.value != null
                                            &amp;&amp; (!isInRange(specifiedPhysicalFLUXGeographicalCoordinate.longitudeMeasure.value, -180, 180) || getNumberOfDecimalPlaces(specifiedPhysicalFLUXGeographicalCoordinate.longitudeMeasure.value, false) &lt; 1)"/>
            <column name="rule_id" value="212"/>
            <column name="failure_message" value="Invalid longitude value."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="241"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!containsAny(relatedFLUXReportDocumentIDs, nonUniqueIdsList) &amp;&amp; (codeTypeValueEquals(typeCode, &quot;DECLARATION&quot;) &amp;&amp; codeTypeValueEquals(purposeCode, &quot;9&quot;) &amp;&amp; (containsMoreThenOneDeclarationPerTrip(faTypesPerTrip, FishingActivityType.DEPARTURE) || containsMoreThenOneArrivalOrDeparture(FishingActivityType.DEPARTURE) || containsMoreThenOneArrivalOrDepartureInFaReportsOfTheMessage(FishingActivityType.DEPARTURE)))"/>
            <column name="rule_id" value="241"/>
            <column name="failure_message" value="More than one departure was found for this trip."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="248"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(faReportDocumentTypeCode, &quot;DECLARATION&quot;) &amp;&amp;                           (codeTypeValueEquals(reasonCode, &quot;TRZ&quot;) || codeTypeValueEquals(reasonCode, &quot;FIS&quot;)) &amp;&amp; speciesTargetCode == null"/>
            <column name="rule_id" value="248"/>
            <column name="failure_message" value="Invalid target species."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="249"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(relatedFishingActivities) &amp;&amp; (isEmpty(relatedFLUXLocations) || relatedFLUXLocations.size &lt;2)"/>
            <column name="rule_id" value="249"/>
            <column name="failure_message" value="Location for this area entry is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="250"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(relatedFluxLocationTypeCodes) || (valueContainsAny(relatedFluxLocationTypeCodes,&quot;POSITION&quot;) || valueContainsAny(relatedFluxLocationTypeCodes,&quot;AREA&quot;))"/>
            <column name="rule_id" value="250"/>
            <column name="failure_message" value="Location TypeCode for this area entry is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="251"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFLUXLocations) &amp;&amp; !fluxLocationIDIsValid(relatedFLUXLocations)"/>
            <column name="rule_id" value="251"/>
            <column name="failure_message" value="Location ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="252"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFACatches) &amp;&amp; !valueContainsAny(faReportDocumentTypeCode, &quot;DECLARATION&quot;, &quot;NOTIFICATION&quot;) &amp;&amp; valueContainsAny(specifiedFACatchesTypeCodes, &quot;ONBOARD&quot;)"/>
            <column name="rule_id" value="252"/>
            <column name="failure_message" value="Catch TypeCode ONBOARD is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="256"/>
            <column name="context" value="EU"/>
            <column name="expression" value="vesselRelatedActivityCode == null"/>
            <column name="rule_id" value="256"/>
            <column name="failure_message" value="Vessel Activity code missing for this fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="257"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!valueContainsAny(fishingGearRoleCodes, &quot;DEPLOYED&quot;) &amp;&amp; operationsQuantity == null"/>
            <column name="rule_id" value="257"/>
            <column name="failure_message" value="Number of operations is missing for this fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="258"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(relatedFishingActivities) &amp;&amp; isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="258"/>
            <column name="failure_message" value="Location for this fishing operation is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="259"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFishingActivities) &amp;&amp; !isFLUXLocationPresentForFishingActivity(relatedFishingActivities) &amp;&amp; isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="259"/>
            <column name="failure_message" value="Location for this fishing operation is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="260"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFishingActivities) &amp;&amp; !codeTypeValueContainsMatch(relatedFishingActivityTypeCodes,&quot;GEAR_SHOT&quot;,&quot;GEAR_RETRIEVAL&quot;)"/>
            <column name="rule_id" value="260"/>
            <column name="failure_message" value="Invalid sub-activity type for this fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="79"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(vesselTransportMeans) &amp;&amp; verifyContactPartyRule(vesselTransportMeans)"/>
            <column name="rule_id" value="79"/>
            <column name="failure_message"
                    value="SpecifiedStructuredAddress must be present if used in entity FishingActivity/RelatedVesselTransportMeans and RelatedVesselTransportMeans/RoleCode is PAIR_FISHING_PARTNER."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="421"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations)  "/>
            <column name="rule_id" value="421"/>
            <column name="failure_message" value="Location is missing for this joint fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="422"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFACatchSpeciesCodes) &amp;&amp; specifiedFACatchSpeciesCodes.contains(&quot;BFT&quot;) &amp;&amp; !isEmpty(fluxLocationTypeCode) &amp;&amp; valueContainsAny(fluxLocationTypeCode, &quot;POSITION&quot;)"/>
            <column name="rule_id" value="422"/>
            <column name="failure_message"
                    value="At least one location with TypeCode POSITION must be provided for this joint fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="423"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFishingActivityTypeCode) &amp;&amp; allValueContainsMatch(relatedFishingActivityTypeCode, &quot;RELOCATION&quot;)"/>
            <column name="rule_id" value="423"/>
            <column name="failure_message"
                    value="Only sub-activities with TypeCode RELOCATION may be provided for this joint fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="424"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFishingActivities) &amp;&amp; !ifVesselTransportPresent(relatedFishingActivities)"/>
            <column name="rule_id" value="424"/>
            <column name="failure_message"
                    value="Vessel information of the related vessel(s) is missing for this joint fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="425"/>
            <column name="context" value="EU"/>
            <column name="expression" value="faReportDocVesselRoleCode == null"/>
            <column name="rule_id" value="425"/>
            <column name="failure_message" value="The RoleCode of the related vessel is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="426"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFishingActivities) &amp;&amp; !ifFACatchPresent(relatedFishingActivities)"/>
            <column name="rule_id" value="426"/>
            <column name="failure_message" value="Catch details missing for this joint fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="428"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFishingActivityFaCatchTypeCodes) &amp;&amp; listIdContainsAll(relatedFishingActivityFaCatchTypeCodes, &quot;FA_CATCH_TYPE&quot;) "/>
            <column name="rule_id" value="428"/>
            <column name="failure_message" value="Catch TypeCode for the related activity has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="429"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="subActivity &amp;&amp; codeTypeValueEquals(faReportDocumentTypeCode, &quot;DECLARATION&quot;) &amp;&amp; (mainActivityType == &quot;JOINT_FISHING_OPERATION&quot;) &amp;&amp;                            !atLeastOneFaCatchWithBFTAndAllocatedQuotaPresent()"/>
            <column name="rule_id" value="429"/>
            <column name="failure_message" value="Catch TypeCode for the related activity is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="109"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(fishingActivityIds) &amp;&amp; !isEmpty(relatedFishingActivityFaCatchTypeCodes) &amp;&amp;  valueContainsAny(relatedFishingActivityFaCatchTypeCodes, &quot;BFT&quot;) &amp;&amp;  schemeIdContainsAll(fishingActivityIds,&quot;JFO&quot;) "/>
            <column name="rule_id" value="109"/>
            <column name="failure_message" value="Fishing Activity ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="110"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(fishingActivityIds) &amp;&amp; mdrService.validateFormat(fishingActivityIds, creationDateOfMessage)"/>
            <column name="rule_id" value="110"/>
            <column name="failure_message" value="Fishing Activity ID is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="247"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="reasonCode != null &amp;&amp; codeTypeValueEquals(faReportDocumentTypeCode, &quot;DECLARATION&quot;) &amp;&amp; listIdContainsAll(reasonCode, &quot;FA_REASON_ENTRY&quot;)"/>
            <column name="rule_id" value="247"/>
            <column name="failure_message" value="The listID for the reason for entry is not valid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="267"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(relatedFLUXLocations) &amp;&amp; allValueContainsMatch(relatedFLUXLocationTypeCodes, &quot;POSITION&quot;)"/>
            <column name="rule_id" value="267"/>
            <column name="failure_message" value="Location TypeCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="268"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; isEmpty(relatedVesselTransportMeans)"/>
            <column name="rule_id" value="268"/>
            <column name="failure_message"
                    value="Vessel information of the related vessel(s) is missing for thisrelocation operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="270"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(relatedVesselTransportMeans) &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; !isEmpty(relatedVesselTransportMeansIDs) &amp;&amp;                            schemeIdContainsAny(relatedVesselTransportMeansIDs, &quot;ICCAT&quot;)"/>
            <column name="rule_id" value="270"/>
            <column name="failure_message" value="ICCAT number missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="273"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(relatedVesselTransportMeans) &amp;&amp; !valueContainsAny(specifiedFACatchTypeCodes, &quot;UNLOADED&quot;) &amp;&amp; !isEmpty(relatedVesselTransportMeans) &amp;&amp;                            valueContainsAny(relatedVesselTransportMeansRoleCodes, &quot;RECEIVER&quot;)"/>
            <column name="rule_id" value="273"/>
            <column name="failure_message" value="Invalid RoleCode for the related vessel."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="274"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(relatedVesselTransportMeans) &amp;&amp; !valueContainsAny(specifiedFACatchTypeCodes, &quot;LOADED&quot;) &amp;&amp;                            valueContainsAny(relatedVesselTransportMeansRoleCodes, &quot;DONOR&quot;)"/>
            <column name="rule_id" value="274"/>
            <column name="failure_message" value="Invalid RoleCode for the related vessel."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="275"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; !isEmpty(relatedVesselTransportMeans) &amp;&amp; !valueContainsAny(specifiedFACatchTypeCodes, &quot;UNLOADED&quot;)                           &amp;&amp; isEmpty(destinationFLUXLocations)"/>
            <column name="rule_id" value="275"/>
            <column name="failure_message" value="Destination location of the BFT catches missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="276"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(specifiedFACatchDestinationFluxLocationTypeCodes) &amp;&amp; !isEmpty(specifiedFACatches) &amp;&amp;                            !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp;                            valueContainsAny(specifiedFACatchDestinationFluxLocationTypeCodes, &quot;LOCATION&quot;)"/>
            <column name="rule_id" value="276"/>
            <column name="failure_message" value="Destination location TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="277"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; !isEmpty(specifiedFACatchDestinationFluxLocationIDs) &amp;&amp;                     (schemeIdContainsAny(specifiedFACatchDestinationFluxLocationIDs, &quot;FARM&quot;) || !mdrService.isPresentInMDRList(&quot;FARM&quot;, getValueForSchemeId(&quot;FARM&quot;, specifiedFACatchDestinationFluxLocationIDs), creationDateOfMessage))"/>
            <column name="rule_id" value="277"/>
            <column name="failure_message"
                    value="The schemeID of the destination location ID or the ID value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="430"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; isEmpty(faReportDocumentRelatedReportIds)"/>
            <column name="rule_id" value="430"/>
            <column name="failure_message" value="FRelated report ID of the JFO catches is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="442"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; isEmpty(relatedVesselTransportMeansNames)"/>
            <column name="rule_id" value="442"/>
            <column name="failure_message"
                    value="The name of the vessel participating to this relocation/transfer is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="443"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; valueContainsAny(specifiedFACatchTypeCodes, &quot;LOADED&quot;, &quot;UNLOADED&quot;)"/>
            <column name="rule_id" value="443"/>
            <column name="failure_message" value="Catch TypeCode values LOADED or UNLOADED missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="446"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; isEmpty(relatedVesselTransportMeansContactPartyRoleCodes)"/>
            <column name="rule_id" value="446"/>
            <column name="failure_message" value="The RoleCode of the related vessel is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="447"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; !isEmpty(relatedVesselTransportMeansContactPartyRoleCodes) &amp;&amp;                            (listIdNotContains(relatedVesselTransportMeansContactPartyRoleCodes, &quot;FLUX_CONTACT_ROLE&quot;) || valueContainsAny(relatedVesselTransportMeansContactPartyRoleCodes, &quot;MASTER&quot;))"/>
            <column name="rule_id" value="447"/>
            <column name="failure_message" value="Invalid schemeID or value for the RoleCode of the related vessel."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="281"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="281"/>
            <column name="failure_message" value="Location of the discard is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="283"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(specifiedFACatchTypeCode) || valueCodeTypeContainsAny(specifiedFACatchTypeCode, &quot;DISCARDED&quot;, &quot;DEMINIMIS&quot;)  "/>
            <column name="rule_id" value="283"/>
            <column name="failure_message" value="Mandatory catch TypeCode value missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="284"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(reasonCode != null  &amp;&amp; reasonCode.value != null  &amp;&amp; reasonCode.listId != null) &amp;&amp; (reasonCode.listId != &quot;FA_REASON_DISCARD&quot; ||                            reasonCode.value == &quot;QEX&quot; || reasonCode.value == &quot;OTH&quot;)"/>
            <column name="rule_id" value="284"/>
            <column name="failure_message"
                    value="The ReasonCode value must be from the code list FA_REASON_DISCARD but may not be QEX or OTH."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="286"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations) || relatedFLUXLocations.size &lt;2"/>
            <column name="rule_id" value="286"/>
            <column name="failure_message" value="Location information missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="287"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueContainsAny(relatedFluxLocationTypeCodes,&quot;POSITION&quot;) || valueContainsAny(relatedFluxLocationTypeCodes,&quot;AREA&quot;)"/>
            <column name="rule_id" value="287"/>
            <column name="failure_message" value="Location TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="288"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!verifyFLUXLocationIDValue(relatedFLUXLocations)"/>
            <column name="rule_id" value="288"/>
            <column name="failure_message" value="Location ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="289"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFACatchesTypeCodes) &amp;&amp; valueContainsAny(specifiedFACatchesTypeCodes, &quot;ONBOARD&quot;)"/>
            <column name="rule_id" value="289"/>
            <column name="failure_message"
                    value="SpecifiedFA_ Catch TypeCode Must have at least one occurrence with Type ONBOARD."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="291"/>
            <column name="context" value="EU"/>
            <column name="expression" value="occurrenceDateTime == null"/>
            <column name="rule_id" value="291"/>
            <column name="failure_message" value="Occurrence date/time missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="292"/>
            <column name="context" value="EU"/>
            <column name="expression" value="reasonCode == null"/>
            <column name="rule_id" value="292"/>
            <column name="failure_message" value="ReasonCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="293"/>
            <column name="context" value="EU"/>
            <column name="expression" value="listIdContainsAll(reasonCode, &quot;FA_REASON_ARRIVAL&quot;)"/>
            <column name="rule_id" value="293"/>
            <column name="failure_message" value="ReasonCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="294"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="294"/>
            <column name="failure_message" value="Location information missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="295"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!anyFluxLocationTypeCodeContainsValue(relatedFLUXLocations, &quot;LOCATION&quot;)"/>
            <column name="rule_id" value="295"/>
            <column name="failure_message" value="Mandatory location TypeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="296"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(reasonCode, &quot;LAN&quot;) &amp;&amp; isEmpty(specifiedFACatches)"/>
            <column name="rule_id" value="296"/>
            <column name="failure_message" value="Catch information missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="297"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFACatches) &amp;&amp; (isEmpty(specifiedFACatchTypeCodes) || valueContainsAny(specifiedFACatchTypeCodes, &quot;ONBOARD&quot;))"/>
            <column name="rule_id" value="297"/>
            <column name="failure_message" value="Mandatory catch TypeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="298"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(reasonCode, &quot;LAN&quot;) &amp;&amp; !isEmpty(specifiedFACatches) &amp;&amp; !isEmpty(specifiedFACatchTypeCodes) &amp;&amp;                            valueContainsAny(specifiedFACatchTypeCodes, &quot;UNLOADED&quot;)"/>
            <column name="rule_id" value="298"/>
            <column name="failure_message" value="Mandatory catch TypeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="299"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!validDelimitedPeriod(delimitedPeriods, true, false)"/>
            <column name="rule_id" value="299"/>
            <column name="failure_message"
                    value="Start date of the trip must be provided for a noticication of arrival."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="415"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(reasonCode, &quot;LAN&quot;) &amp;&amp; (isEmpty(specifiedFLUXCharacteristicsTypeCodes) || !codeTypeValueContainsOnly(specifiedFLUXCharacteristicsTypeCodes, &quot;START_DATETIME_LANDING&quot;) || !isIsoDateStringValidFormat(specifiedFLUXCharacteristicValueDateTimes))"/>
            <column name="rule_id" value="415"/>
            <column name="failure_message"
                    value="If the activity is an arrival notification check presence of SpecifiedFLUXCharacteristic/TypeCode                     It must be present and equal to START_DATETIME_LANDING if ReasonCode is LAN (landing).                     ValueDateTime must be date/time in UTC according to ISO8601 and format YYYY-MM-DDThh:mm:ssZ (optional milliseconds)."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="416"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFLUXCharacteristicsTypeCodes) &amp;&amp; listIdContainsAll(specifiedFLUXCharacteristicsTypeCodes, &quot;FA_CHARACTERISTIC&quot;)"/>
            <column name="rule_id" value="416"/>
            <column name="failure_message" value="FLUX characteristic has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="301"/>
            <column name="context" value="EU"/>
            <column name="expression" value="occurrenceDateTime == null "/>
            <column name="rule_id" value="301"/>
            <column name="failure_message" value="Occurrence date/time missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="302"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="reasonCode != null &amp;&amp; listIdContainsAll(reasonCode, &quot;FA_REASON_ARRIVAL&quot;)"/>
            <column name="rule_id" value="302"/>
            <column name="failure_message" value="ReasonCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="303"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="303"/>
            <column name="failure_message" value="Location of arrival is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="304"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(fluxLocationTypeCodes) &amp;&amp; valueCodeTypeContainsAny(fluxLocationTypeCodes, &quot;LOCATION&quot;)"/>
            <column name="rule_id" value="304"/>
            <column name="failure_message" value="At least the port of arrival (location) must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="305"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(fishingGearRoleCodes) &amp;&amp; allValueContainsMatch(fishingGearRoleCodes, &quot;ONBOARD&quot;)"/>
            <column name="rule_id" value="305"/>
            <column name="failure_message" value="Invalid RoleCode for the gear provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="311"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFluxLocations)"/>
            <column name="rule_id" value="311"/>
            <column name="failure_message" value="Location missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="312"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(relatedFluxLocationTypeCodes) &amp;&amp; valueContainsAny(relatedFluxLocationTypeCodes,&quot;LOCATION&quot;,&quot;POSITION&quot;,&quot;ADDRESS&quot;)"/>
            <column name="rule_id" value="312"/>
            <column name="failure_message" value="Location TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="313"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFaCatchTypeCode) &amp;&amp; anyValueContainsAll(specifiedFaCatchTypeCode,&quot;UNLOADED&quot;) "/>
            <column name="rule_id" value="313"/>
            <column name="failure_message" value="Mandatory location TypeCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="314"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFaCatches) &amp;&amp; validateFluxLocationsForFaCatch(specifiedFaCatches)"/>
            <column name="rule_id" value="314"/>
            <column name="failure_message" value="Location where the catches are taken must be specified."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="315"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isSpecifiedFluxLocFromFaCatch &amp;&amp; faCatch != null &amp;&amp; (faRepDocType ==&quot;DECLARATION&quot;)                            &amp;&amp; (activityType == &quot;LANDING&quot;) &amp;&amp; !faCatchContainsSpecifiedFluxLocationOfType(&quot;AREA&quot;)"/>
            <column name="rule_id" value="315"/>
            <column name="failure_message" value="The area where the catches were taken must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="445"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(faCatchTypeCodes) || valueContainsAny(faCatchTypeCodes, &quot;LOADED&quot;, &quot;UNLOADED&quot;)"/>
            <column name="rule_id" value="445"/>
            <column name="failure_message" value="The catches being loaded or unloaded in this operation are missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="321"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="321"/>
            <column name="failure_message" value="The transhipment location is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="322"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(fluxLocationTypeCodes) &amp;&amp; valueContainsAny(fluxLocationTypeCodes,&quot;LOCATION&quot;) &amp;&amp; valueContainsAny(fluxLocationTypeCodes, &quot;POSITION&quot;)  "/>
            <column name="rule_id" value="322"/>
            <column name="failure_message" value="At least a port or position must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="323"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedVesselTransportMeans)"/>
            <column name="rule_id" value="323"/>
            <column name="failure_message"
                    value="Information concerning the other vessel involved in the transhipment is missing. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="324"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(vesselTransportMeansRoleCodes) &amp;&amp; !isEmpty(faCatchTypeCodes) &amp;&amp;                     !valueContainsAny(faCatchTypeCodes, &quot;UNLOADED&quot;) &amp;&amp; allValueContainsMatch(vesselTransportMeansRoleCodes, &quot;RECEIVER&quot;)"/>
            <column name="rule_id" value="324"/>
            <column name="failure_message" value="Invalid RoleCode for the related vessel."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="325"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(vesselTransportMeansRoleCodes) &amp;&amp; !isEmpty(faCatchTypeCodes) &amp;&amp; !valueContainsAny(faCatchTypeCodes, &quot;LOADED&quot;) &amp;&amp; allValueContainsMatch(vesselTransportMeansRoleCodes, &quot;DONOR&quot;)"/>
            <column name="rule_id" value="325"/>
            <column name="failure_message" value="Invalid RoleCode for the related vessel."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="326"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(specifiedFACatches) &amp;&amp; !checkFLUXLocationForFaCatch(specifiedFACatches)"/>
            <column name="rule_id" value="326"/>
            <column name="failure_message" value="The location where the catches have been taken is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="327"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(faCtchSpecifiedFLUXLocationsTypeCodes) &amp;&amp; allValueContainsMatch(faCtchSpecifiedFLUXLocationsTypeCodes, &quot;AREA&quot;)"/>
            <column name="rule_id" value="327"/>
            <column name="failure_message" value="Area where the catches were taken must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="328"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!valueContainsAny(faCatchTypeCodes, &quot;UNLOADED&quot;) &amp;&amp; isEmpty(fluxCharacteristicTypeCodes)"/>
            <column name="rule_id" value="328"/>
            <column name="failure_message"
                    value="Check presence.Must be present if the activity is a transhipment declaration and SpecifiedFACatch/TypeCode = UNLOADED."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="329"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!valueContainsAny(faCatchTypeCodes, &quot;UNLOADED&quot;) &amp;&amp; !isEmpty(relatedVesselTransportMeans) &amp;&amp;                            (isEmpty(specifiedFLUXCharacteristics) || !valueNotContains(fluxCharacteristicTypeCodes, &quot;DESTINATION_LOCATION&quot;, 0) ||                             !valueNotContains(specifiedFlCharSpecifiedLocatTypeCodes, &quot;LOCATION&quot;, 0) ||                             schemeIdContainsAny(specifiedFlCharSpecifiedLocatIDs, &quot;LOCATION&quot;) )"/>
            <column name="rule_id" value="329"/>
            <column name="failure_message"
                    value="Destination location (port) of the receiving vessel must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="444"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueContainsAny(faCatchTypeCode, &quot;LOADED&quot;) &amp;&amp; valueContainsAny(faCatchTypeCode, &quot;UNLOADED&quot;)"/>
            <column name="rule_id" value="444"/>
            <column name="failure_message" value="The catches being loaded or unloaded in this operation are missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="331"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="331"/>
            <column name="failure_message" value="The location of the operation is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="332"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(fluxLocationTypeCode) &amp;&amp; valueContainsAny(fluxLocationTypeCode, &quot;LOCATION&quot;, &quot;POSITION&quot;)"/>
            <column name="rule_id" value="332"/>
            <column name="failure_message" value="At least a port (location) or position must be provided. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="333"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(faCatchSpeciesCodes) &amp;&amp; !valueContainsAny(faCatchSpeciesCodes,&quot;BFT&quot;) &amp;&amp; isEmpty(relatedVesselTransportMeans)  "/>
            <column name="rule_id" value="333"/>
            <column name="failure_message"
                    value="Information concerning the other vessel involved in the operation is missing. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="334"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(vesselTransportMeansRoleCodes) &amp;&amp; !isEmpty(faCatchTypeCode) &amp;&amp; !valueContainsAny(faCatchTypeCode, &quot;UNLOADED&quot;) &amp;&amp;                            allValueContainsMatch(vesselTransportMeansRoleCodes, &quot;RECEIVER&quot;)"/>
            <column name="rule_id" value="334"/>
            <column name="failure_message" value="Invalid RoleCode for the related vessel.  "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="336"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="fishingActivityTypeCode != null &amp;&amp; fishingActivityTypeCode.value == &quot;RELOCATION&quot; &amp;&amp; containsAnyFaCatch(specifiedFACatches,&quot;BFT&quot;,&quot;UNLOADED&quot;) &amp;&amp; valueCodeTypeContainsAny(fluxCharacteristicTypeCodes, &quot;NB_CAGES_TOWED&quot;)"/>
            <column name="rule_id" value="336"/>
            <column name="failure_message" value="FLUX Characteristic NB_CAGES_TOWED is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10028"/>
            <column name="context" value="EU"/>
            <column name="expression" value="categoryCode == null"/>
            <column name="rule_id" value="10028"/>
            <column name="failure_message" value="Category in SizeDistribution must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="342"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="fishingActivityTypeCode != null &amp;&amp; fishingActivityTypeCode.value == &quot;TRANSHIPMENT&quot; &amp;&amp; isEmpty(relatedVesselTransportMeans)"/>
            <column name="rule_id" value="342"/>
            <column name="failure_message" value="Related vessel information missing. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="343"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="fishingActivityTypeCode != null &amp;&amp; fishingActivityTypeCode.value == &quot;TRANSHIPMENT&quot; &amp;&amp; !isEmpty(vesselTransportMeansRoleCodes) &amp;&amp;                            containsAnyFaCatch(specifiedFACatches,&quot;BFT&quot;,&quot;LOADED&quot;) &amp;&amp; valueCodeTypeContainsAny(vesselTransportMeansRoleCodes ,&quot;DONOR&quot; )"/>
            <column name="rule_id" value="343"/>
            <column name="failure_message" value="Invalid RoleCode for the related vessel."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="344"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="fishingActivityTypeCode != null &amp;&amp; fishingActivityTypeCode.value == &quot;TRANSHIPMENT&quot; &amp;&amp; !isEmpty(specifiedFACatches) &amp;&amp;                            !ifFLUXLocationForFACatchIsAREA(specifiedFACatches)"/>
            <column name="rule_id" value="344"/>
            <column name="failure_message" value="The area where the catches were taken must be provided. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="350"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="350"/>
            <column name="failure_message" value="TypeCode is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="351"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode != null &amp;&amp; typeCode.listId != &quot;FA_QUERY_TYPE&quot;"/>
            <column name="rule_id" value="351"/>
            <column name="failure_message" value="TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="352"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listId, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="352"/>
            <column name="failure_message" value="TypeCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="353"/>
            <column name="context" value="EU"/>
            <column name="expression" value="id != null &amp;&amp; schemeIdContainsAny(id, &quot;UUID&quot;)"/>
            <column name="rule_id" value="353"/>
            <column name="failure_message" value="ID has an invalid schemeID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="354"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="id != null &amp;&amp; id.schemeId != null &amp;&amp; mdrService.validateFormat(id, creationDateOfMessage)"/>
            <column name="rule_id" value="354"/>
            <column name="failure_message" value="ID has an invalid format."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="355"/>
            <column name="context" value="EU"/>
            <column name="expression" value="submittedDateTime == null"/>
            <column name="rule_id" value="355"/>
            <column name="failure_message" value="Date/time of submission of the query must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="356"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isIsoDateStringValidFormat(submittedDateTimeString)"/>
            <column name="rule_id" value="356"/>
            <column name="failure_message"
                    value="The date/time of submission if the query must be a valid UTC date and in the correct format."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="358"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(submittedFLUXPartyIds)"/>
            <column name="rule_id" value="358"/>
            <column name="failure_message" value="Submitter ID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="359"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(submittedFLUXPartyIds) &amp;&amp; schemeIdContainsAll(submittedFLUXPartyIds, &quot;FLUX_GP_PARTY&quot;)"/>
            <column name="rule_id" value="359"/>
            <column name="failure_message" value="Submitter ID has an invalid schemeID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="360"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(submittedFLUXPartyIds) &amp;&amp; !matchWithFluxTL(submittedFLUXPartyIds)"/>
            <column name="rule_id" value="360"/>
            <column name="failure_message" value="Submitter ID is not consistent with FLUX TL envelope parameters."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="361"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(typeCode, &quot;VESSEL&quot;) &amp;&amp; specifiedDelimitedPeriod == null"/>
            <column name="rule_id" value="361"/>
            <column name="failure_message" value="A delimited period must be provided for this type of query."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="362"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedDelimitedPeriod != null &amp;&amp; specifiedDelimitedPeriod.startDateTime == null"/>
            <column name="rule_id" value="362"/>
            <column name="failure_message" value="Start date/time must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="363"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(sdpStartDateTimeString) &amp;&amp; !isIsoDateStringValidFormat(sdpStartDateTimeString)"/>
            <column name="rule_id" value="363"/>
            <column name="failure_message" value="Start date/time must be a valid UTC date in the correct format."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="364"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedDelimitedPeriod != null &amp;&amp; isEmpty(sdpEndDateTimeString)"/>
            <column name="rule_id" value="364"/>
            <column name="failure_message" value="End date/time must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="365"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedDelimitedPeriod != null &amp;&amp; !isIsoDateStringValidFormat(sdpEndDateTimeString)"/>
            <column name="rule_id" value="365"/>
            <column name="failure_message" value="End date/time must be a valid UTC date in the correct format."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="366"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="simpleFAQueryParameterTypeCodes != null &amp;&amp; simpleFAQueryParameterTypeCodes.size &lt;2"/>
            <column name="rule_id" value="366"/>
            <column name="failure_message" value="At least 2 query parameters must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="367"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="simpleFAQueryParameterTypeCodes != null &amp;&amp; valueNotContains(simpleFAQueryParameterTypeCodes, &quot;CONSOLIDATED&quot;, 1)"/>
            <column name="rule_id" value="367"/>
            <column name="failure_message" value="Exactly one occurrence must be value CONSOLIDATED."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="357"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="submittedDateTime != null &amp;&amp; dateNotInPast(submittedDateTime, 10)"/>
            <column name="rule_id" value="357"/>
            <column name="failure_message" value="The date/time of sumission if the query must be in the past."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="375"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="simpleFAQueryParameterTypeCodes != null &amp;&amp; count(simpleFAQueryParameterTypeCodes, &quot;VESSELID&quot;) &gt; 1"/>
            <column name="rule_id" value="375"/>
            <column name="failure_message" value="Not more than one VESSELID may be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="369"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.listId != &quot;FA_QUERY_PARAMETER&quot;"/>
            <column name="rule_id" value="369"/>
            <column name="failure_message" value="Query parameter TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="370"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listId, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="370"/>
            <column name="failure_message" value="The value of the query parameter TypeCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="371"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(typeCode, &quot;VESSEL&quot;) &amp;&amp;                     (valueContainsAny(simpleFAQueryParameterTypeCodes,&quot;VESSELID&quot;) || !valueContainsAny(simpleFAQueryParameterTypeCodes,&quot;TRIPID&quot;))                     || (codeTypeValueEquals(typeCode, &quot;TRIP&quot;) &amp;&amp;                     (valueContainsAny(simpleFAQueryParameterTypeCodes,&quot;TRIPID&quot;) || !valueContainsAny(simpleFAQueryParameterTypeCodes,&quot;VESSELID&quot;)))"/>
            <column name="rule_id" value="371"/>
            <column name="failure_message"
                    value="Must be value VESSELID if  FAQuery/TypeCode is VESSEL or must be value TRIPID if FAQuery/TypeCode is TRIP"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="372"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueID == null &amp;&amp; typeCode != null &amp;&amp; (typeCode.value == &quot;VESSELID&quot; || typeCode.value == &quot;TRIPID&quot;)"/>
            <column name="rule_id" value="372"/>
            <column name="failure_message" value="ValueID missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="373"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueID != null &amp;&amp; typeCode != null &amp;&amp; typeCode.value == &quot;VESSELID&quot; &amp;&amp;                     !mdrService.isAllSchemeIdsPresentInMDRList(&quot;FLUX_VESSEL_ID_TYPE&quot;, Arrays.asList(valueID), creationDateOfMessage)"/>
            <column name="rule_id" value="373"/>
            <column name="failure_message" value="The ValueID schemeID is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="374"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value == &quot;VESSELID&quot; &amp;&amp; (valueID == null || (valueID.schemeId != &quot;CFR&quot; &amp;&amp; valueID.schemeId != &quot;IRCS&quot;))"/>
            <column name="rule_id" value="374"/>
            <column name="failure_message" value="The ValueID schemeID is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="376"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value == &quot;TRIPID&quot; &amp;&amp; schemeIdContainsAll(valueID, &quot;EU_TRIP_ID&quot;)"/>
            <column name="rule_id" value="376"/>
            <column name="failure_message" value="The ValueID schemeID is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="377"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueID != null &amp;&amp; mdrService.validateFormat(valueID, creationDateOfMessage)"/>
            <column name="rule_id" value="377"/>
            <column name="failure_message" value="The valueID is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="378"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value == &quot;CONSOLIDATED&quot; &amp;&amp; valueCode == null"/>
            <column name="rule_id" value="378"/>
            <column name="failure_message" value="ValueCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="379"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueCode != null &amp;&amp; valueCode.value != &quot;Y&quot; &amp;&amp; valueCode.value != &quot;N&quot;"/>
            <column name="rule_id" value="379"/>
            <column name="failure_message" value="ValueCode is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="380"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isEmpty(ids) &amp;&amp; schemeIdContainsAll(ids, &quot;UUID&quot;)  "/>
            <column name="rule_id" value="380"/>
            <column name="failure_message" value="Response message ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="381"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; mdrService.validateFormat(ids, creationDateOfMessage)"/>
            <column name="rule_id" value="381"/>
            <column name="failure_message" value="Response message ID value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="382"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; (getValueForSchemeId(&quot;FA_RESPONSE&quot;, idsExistinigInTheDb) != null)"/>
            <column name="rule_id" value="382"/>
            <column name="failure_message"
                    value="The identification of the FLUX response Document must be unique and not already exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="383"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="referencedID != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;FLUX_GP_MSG_ID&quot;, referencedID.schemeId, creationDateOfMessage)"/>
            <column name="rule_id" value="383"/>
            <column name="failure_message" value="Response referenced ID has invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="384"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="referencedID != null &amp;&amp; mdrService.validateFormat(referencedID, creationDateOfMessage)  "/>
            <column name="rule_id" value="384"/>
            <column name="failure_message" value="Response referenced ID value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="385"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="messageType == &quot;PULL&quot; &amp;&amp; referencedID != null &amp;&amp; (getValueForSchemeId(&quot;FA_QUERY_ID&quot;, idsExistinigInTheDb) == null) &amp;&amp;                 (getValueForSchemeId(&quot;FA_MESSAGE_ID&quot;, idsExistinigInTheDb) == null)"/>
            <column name="rule_id" value="385"/>
            <column name="failure_message"
                    value="The identification must exist for a FLUXFAReportMessage or for a FLUXFAQuery message."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="386"/>
            <column name="context" value="EU"/>
            <column name="expression" value="responseCode ==null"/>
            <column name="rule_id" value="386"/>
            <column name="failure_message" value="ResponseCode missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="387"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="responseCode != null &amp;&amp; listIdContainsAll(responseCode, &quot;FLUX_GP_RESPONSE&quot;)"/>
            <column name="rule_id" value="387"/>
            <column name="failure_message" value="ResponseCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="388"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="responseCode != null &amp;&amp; !mdrService.isPresentInMDRList(responseCode.listId, responseCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="388"/>
            <column name="failure_message" value="ResponseCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="389"/>
            <column name="context" value="EU"/>
            <column name="expression" value="creationDateTime == null"/>
            <column name="rule_id" value="389"/>
            <column name="failure_message" value="Response creation date/time is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="390"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isValid(creationDateTime)"/>
            <column name="rule_id" value="390"/>
            <column name="failure_message"
                    value="Response creation date/time must be a valid UTC date and in the correct."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="391"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="creationDateTime != null &amp;&amp; dateNow().before(toDate(creationDateTime))"/>
            <column name="rule_id" value="391"/>
            <column name="failure_message" value="Response creation date/time must be in the past."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="553"/>
            <column name="context" value="EU"/>
            <column name="expression" value="respondentFLUXParty == null"/>
            <column name="rule_id" value="553"/>
            <column name="failure_message" value="Respondent party is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="368"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="responseCode != null &amp;&amp; responseCode.value != null  &amp;&amp; responseCode.value != &quot;OK&quot; &amp;&amp; isEmpty(relatedValidationResultDocuments)  "/>
            <column name="rule_id" value="368"/>
            <column name="failure_message" value="Validation results are missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="392"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(fluxPartyIds)"/>
            <column name="rule_id" value="392"/>
            <column name="failure_message" value="The respondent ID is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="393"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(fluxPartyIds) &amp;&amp; schemeIdContainsAll(fluxPartyIds, &quot;FLUX_GP_PARTY&quot;)"/>
            <column name="rule_id" value="393"/>
            <column name="failure_message" value="Respondent ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="394"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isEmpty(fluxPartyIds) &amp;&amp; !matchWithFluxTL(fluxPartyIds)"/>
            <column name="rule_id" value="394"/>
            <column name="failure_message" value="Respondent ID is not consistent with FLUX TL envelope parameters."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="395"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isValidatorIdPresent(relatedValidationResultDocuments)"/>
            <column name="rule_id" value="395"/>
            <column name="failure_message" value="Validator ID is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="396"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(validatorIDs) &amp;&amp; schemeIdContainsAll(validatorIDs, &quot;FLUX_GP_PARTY&quot;)  "/>
            <column name="rule_id" value="396"/>
            <column name="failure_message" value="Validator ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="555"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(validatorIDs) &amp;&amp; !mdrService.isIdTypePresentInMDRList(validatorIDs, creationDateOfMessage)"/>
            <column name="rule_id" value="555"/>
            <column name="failure_message" value="Validator ID value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="554"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!codeTypeValueEquals(responseCode, &quot;OK&quot;) &amp;&amp; !isValidationQualityAnalysisPresent(relatedValidationResultDocuments)"/>
            <column name="rule_id" value="554"/>
            <column name="failure_message" value="Quality analysis details are missing"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="397"/>
            <column name="context" value="EU"/>
            <column name="expression" value="id == null"/>
            <column name="rule_id" value="397"/>
            <column name="failure_message" value="Quality analysis ID is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="398"/>
            <column name="context" value="EU"/>
            <column name="expression" value="id != null &amp;&amp; id.schemeId != &quot;FA_BR&quot;"/>
            <column name="rule_id" value="398"/>
            <column name="failure_message" value="Quality analysis ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="399"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="id != null &amp;&amp; !mdrService.isPresentInMDRList(id.schemeId, id.value, creationDateOfMessage)"/>
            <column name="rule_id" value="399"/>
            <column name="failure_message" value="Quality analysis ID value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="400"/>
            <column name="context" value="EU"/>
            <column name="expression" value="levelCode == null"/>
            <column name="rule_id" value="400"/>
            <column name="failure_message" value="LevelCode is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="401"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="levelCode != null &amp;&amp; levelCode.listId != &quot;FLUX_GP_VALIDATION_LEVEL&quot;"/>
            <column name="rule_id" value="401"/>
            <column name="failure_message" value="LevelCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="402"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="levelCode != null &amp;&amp; !mdrService.isPresentInMDRList(levelCode.listId, levelCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="402"/>
            <column name="failure_message" value="LevelCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="403"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.listId != &quot;FLUX_GP_VALIDATION_TYPE&quot;"/>
            <column name="rule_id" value="403"/>
            <column name="failure_message" value="TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="404"/>
            <column name="context" value="EU"/>
            <column name="expression" value="containsEmptyStrings(results)"/>
            <column name="rule_id" value="404"/>
            <column name="failure_message" value="Textual description is empty."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="405"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="id != null &amp;&amp; id.value != &quot;FA-L00-00-0000&quot; &amp;&amp;                 (codeTypeValueEquals(typeCode, &quot;ERR&quot;) || codeTypeValueEquals(typeCode, &quot;WAR&quot;)) &amp;&amp; containsOnlyEmptyStrings(referencedItems)"/>
            <column name="rule_id" value="405"/>
            <column name="failure_message" value="Referenced item(s) missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="406"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode !=null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listId , typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="406"/>
            <column name="failure_message" value="TypeCode value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="204"/>
            <column name="context" value="EU"/>
            <column name="expression" value="rfmo != null &amp;&amp; rfmo.listId != &quot;RFMO&quot;"/>
            <column name="rule_id" value="204"/>
            <column name="failure_message" value="RFMO code has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="205"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="rfmo != null &amp;&amp; !mdrService.isTypeCodeValuePresentInList(rfmo.listId, rfmo, creationDateOfMessage)"/>
            <column name="rule_id" value="205"/>
            <column name="failure_message" value="RFMO code value is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="172"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(appliedAAPProcessTypeCodes) &amp;&amp; !mdrService.isCodeTypeListIdPresentInMDRList(&quot;FLUX_PROCESS_TYPE&quot; , appliedAAPProcessTypeCodes, creationDateOfMessage)"/>
            <column name="rule_id" value="172"/>
            <column name="failure_message" value="The listID for this processing type invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="173"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(appliedAAPProcessTypeCodes) &amp;&amp; !mdrService.isCodeTypePresentInMDRList(appliedAAPProcessTypeCodes, creationDateOfMessage)"/>
            <column name="rule_id" value="173"/>
            <column name="failure_message" value="The value of the processing type is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="157"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(unitQuantity) &amp;&amp; !codeTypeValueEquals(fishingActivityTypeCode, &quot;LANDING&quot;) &amp;&amp; !codeTypeValueEquals(fishingActivityTypeCode, &quot;TRANSHIPMENT&quot;) &amp;&amp; codeTypeValueEquals(speciesCode, &quot;SAL&quot;) &amp;&amp; !schemeIdContainsAny(fishActRelatedFluxLocationIds, &quot;FAO_AREA&quot;) &amp;&amp; containsAtLeastOneFaoAreaWithValidValue(fishActRelatedFluxLocationIds)"/>
            <column name="rule_id" value="157"/>
            <column name="failure_message"
                    value="Units (number of fish) must be provided for Salmon in the Baltic sea"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10030"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="10030"/>
            <column name="failure_message" value="Type in Fishing Activity must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="219"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isEmpty(resultAAPProduct) &amp;&amp; ((codeTypeValueEquals(fishingActivityTypeCode, &quot;LANDING&quot;) || codeTypeValueEquals(fishingActivityTypeCode, &quot;TRANSHIPMENT&quot;)) &amp;&amp;                      (codeTypeValueEquals(typeCode, &quot;UNLOADED&quot;) || codeTypeValueEquals(typeCode, &quot;LOADED&quot;)) ||                      ((unitQuantity == null || unitQuantity.value == null) &amp;&amp; (weightMeasure == null || weightMeasure.value == null)))"/>
            <column name="rule_id" value="219"/>
            <column name="failure_message" value="Information about product details is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="217"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isSpecifiedFluxLocFromFaCatch &amp;&amp; (rfmo == null || isEmpty(rfmo.value))"/>
            <column name="rule_id" value="217"/>
            <column name="failure_message" value="RFMO code missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="410"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; isEmpty(unitQuantity) &amp;&amp; !codeTypeValueEquals(fishingActivityTypeCode, &quot;LANDING&quot;) &amp;&amp; !codeTypeValueEquals(fishingActivityTypeCode, &quot;TRANSHIPMENT&quot;) &amp;&amp; codeTypeValueEquals(speciesCode, &quot;BFT&quot;) &amp;&amp;                     !schemeIdContainsAny(fishActRelatedFluxLocationIds, &quot;GFCM_GSA&quot;) &amp;&amp; mdrService.isIdTypePresentInMDRList(&quot;GFCM_GSA&quot;,fishActRelatedFluxLocationIds, creationDateOfMessage) &amp;&amp; containsAtLeastOneGfcmGsaWithValidValue(fishActRelatedFluxLocationIds)"/>
            <column name="rule_id" value="410"/>
            <column name="failure_message" value="Units (number of fish) must be provided for Bluefin tuna in GFCM"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="440"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(appliedAAPProcess) &amp;&amp; codeTypeValueEquals(speciesCode, &quot;BFT&quot;) &amp;&amp; !isNumeric(appliedAAPProcessConversionFactorNumber)"/>
            <column name="rule_id" value="440"/>
            <column name="failure_message" value="Conversion factor missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="187"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="speciesCode != null &amp;&amp; fishingActivityTypeCode != null &amp;&amp; isEmpty(resultAAPProductUnitQuantity) &amp;&amp; (fishingActivityTypeCode.value == &quot;LANDING&quot; || fishingActivityTypeCode.value == &quot;TRANSHIPMENT&quot;) &amp;&amp; speciesCode.value != null &amp;&amp; speciesCode.value == &quot;SWO&quot; &amp;&amp; !schemeIdContainsAny(faCatchFluxLocationId, &quot;GFCM_GSA&quot;) "/>
            <column name="rule_id" value="187"/>
            <column name="failure_message"
                    value="Units (number of fish) must be provided for landings/transhipments of Swordfish from GFCM area."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="4401"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(fluxCharacteristicTypeCodes) &amp;&amp; listIdContainsAll(fluxCharacteristicTypeCodes, &quot;FA_CHARACTERISTIC&quot;)"/>
            <column name="rule_id" value="4401"/>
            <column name="failure_message" value="The FLUX Characteristic TypeCode has an invalid listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="229"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_CHARACTERISTIC&quot;, typeCode.value) == &quot;MEASURE&quot; &amp;&amp; valueMeasure != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;FLUX_UNIT&quot;, valueMeasure.unitCode, creationDateOfMessage)"/>
            <column name="rule_id" value="229"/>
            <column name="failure_message" value="Unexpected unit code for Measure."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="417"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!valueContainsAny(specifiedFACatchTypeCodes, &quot;UNLOADED&quot;) &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; schemeIdContainsAny(destinationVesselStorageCharacteristicID, &quot;BFT-CAGE-ID&quot;)"/>
            <column name="rule_id" value="417"/>
            <column name="failure_message"
                    value="Identification of the destination vessel storage must be present and must have a valid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10007"/>
            <column name="context" value="EU"/>
            <column name="expression" value="ownerFLUXParty == null"/>
            <column name="rule_id" value="10007"/>
            <column name="failure_message" value="FLUXParty in FLUXReportDocument must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10009"/>
            <column name="context" value="EU"/>
            <column name="expression" value="itemTypeCode == null"/>
            <column name="rule_id" value="10009"/>
            <column name="failure_message" value="Item Type in SalesReport must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10011"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(includedSalesDocuments)"/>
            <column name="rule_id" value="10011"/>
            <column name="failure_message" value="Sales Document in SalesReport must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10026"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isSalesNoteAndIsFreshnessNotPresent()"/>
            <column name="rule_id" value="10026"/>
            <column name="failure_message" value="Freshness in AAPProcess in AAPProduct must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10029"/>
            <column name="context" value="EU"/>
            <column name="expression" value="doesAFLUXOrganizationNotHaveAName()"/>
            <column name="rule_id" value="10029"/>
            <column name="failure_message" value="Name in FLUX Organization must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10134"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isSalesNoteAndNotAllChargeAmountsAreGreaterThanOrEqualToZero()"/>
            <column name="rule_id" value="10134"/>
            <column name="failure_message" value="Positive or zero value"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10135"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isSalesNoteAndAnyChargeAmountIsEqualToZero()"/>
            <column name="rule_id" value="10135"/>
            <column name="failure_message" value="Charge = 0"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10226"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isSalesNoteAndAtLeastOneChargeAmountIsNull()"/>
            <column name="rule_id" value="10226"/>
            <column name="failure_message" value="Mandatory for products"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10013"/>
            <column name="context" value="EU"/>
            <column name="expression" value="currencyCode == null"/>
            <column name="rule_id" value="10013"/>
            <column name="failure_message" value="Sales Currency in SalesDocument must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10014"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedSalesEvents)"/>
            <column name="rule_id" value="10014"/>
            <column name="failure_message" value="Sales Event in SalesDocument must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10015"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedSalesParties)"/>
            <column name="rule_id" value="10015"/>
            <column name="failure_message" value="Sales Party in SalesDocument must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10016"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isNotVariousSupply() &amp;&amp; isEmpty(specifiedFishingActivities)"/>
            <column name="rule_id" value="10016"/>
            <column name="failure_message" value="Fishing Activity in SalesDocument must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10017"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedFLUXLocations)"/>
            <column name="rule_id" value="10017"/>
            <column name="failure_message" value="Flux Location in SalesDocument must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10018"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedSalesBatches)"/>
            <column name="rule_id" value="10018"/>
            <column name="failure_message" value="Sales Batch in SalesDocument must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10019"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(roleCodes)"/>
            <column name="rule_id" value="10019"/>
            <column name="failure_message" value="Role in SalesParty must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10020"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isBlank(name)"/>
            <column name="rule_id" value="10020"/>
            <column name="failure_message" value="Name in SalesParty must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10021"/>
            <column name="context" value="EU"/>
            <column name="expression" value="speciesCode == null"/>
            <column name="rule_id" value="10021"/>
            <column name="failure_message" value="Species in AAPProduct must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10022"/>
            <column name="context" value="EU"/>
            <column name="expression" value="usageCode == null"/>
            <column name="rule_id" value="10022"/>
            <column name="failure_message" value="Usage in AAPProduct must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10023"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(appliedAAPProcesses)"/>
            <column name="rule_id" value="10023"/>
            <column name="failure_message" value="AAP Process in AAPProduct must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10031"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedDelimitedPeriods)"/>
            <column name="rule_id" value="10031"/>
            <column name="failure_message" value="Delimited Period in Fishing Activity must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10032"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedVesselTransportMeans)"/>
            <column name="rule_id" value="10032"/>
            <column name="failure_message" value="Vessel Transport Means in Fishing Activity must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10034"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFLUXLocations)"/>
            <column name="rule_id" value="10034"/>
            <column name="failure_message" value="FLUX Location in Fishing Activity must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10035"/>
            <column name="context" value="EU"/>
            <column name="expression" value="startDateTime == null || startDateTime.dateTime == null"/>
            <column name="rule_id" value="10035"/>
            <column name="failure_message" value="Start in Delimited Period must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10036"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(IDS)"/>
            <column name="rule_id" value="10036"/>
            <column name="failure_message" value="Identification in Vessel Transport Means must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10038"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedContactParties)"/>
            <column name="rule_id" value="10038"/>
            <column name="failure_message" value="Contact Party in Vessel Transport Means must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10232"/>
            <column name="context" value="EU"/>
            <column name="expression" value="doContactPartiesWithTheSameRoleExist()"/>
            <column name="rule_id" value="10232"/>
            <column name="failure_message" value="No duplicated role"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10039"/>
            <column name="context" value="EU"/>
            <column name="expression" value="ID == null || ID.value == null"/>
            <column name="rule_id" value="10039"/>
            <column name="failure_message" value="Identification in Vessel Country must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10040"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueCodeTypeContainsAny(roleCodes, &quot;MASTER&quot;) &amp;&amp; valueCodeTypeContainsAny(roleCodes, &quot;OPERATOR&quot;)"/>
            <column name="rule_id" value="10040"/>
            <column name="failure_message" value="Master or operator role in Contact Party must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10042"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="10042"/>
            <column name="failure_message" value="TypeCode in FLUX Location must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10043"/>
            <column name="context" value="EU"/>
            <column name="expression" value="latitudeMeasure == null"/>
            <column name="rule_id" value="10043"/>
            <column name="failure_message" value="LatitudeMeasure in FLUXGeographicalCoordinate must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10044"/>
            <column name="context" value="EU"/>
            <column name="expression" value="longitudeMeasure == null"/>
            <column name="rule_id" value="10044"/>
            <column name="failure_message" value="LongitudeMeasure in FLUXGeographicalCoordinate must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10045"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isBlank(cityName)"/>
            <column name="rule_id" value="10045"/>
            <column name="failure_message" value="CityName in StructuredAddress must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10046"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isBlank(countryID)"/>
            <column name="rule_id" value="10046"/>
            <column name="failure_message" value="Country in StructuredAddress must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10047"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isBlank(streetName)"/>
            <column name="rule_id" value="10047"/>
            <column name="failure_message" value="StreetName in StructuredAddress must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10228"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isTotalPriceFieldDifferentFromSumOfProducts()"/>
            <column name="rule_id" value="10228"/>
            <column name="failure_message" value="Total price must be the total of product price"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10100"/>
            <column name="context" value="EU"/>
            <column name="expression" value="schemeIdContainsAll(IDS, &quot;UUID&quot;)"/>
            <column name="rule_id" value="10100"/>
            <column name="failure_message" value="Check attribute schemeID. Must be UUID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10101"/>
            <column name="context" value="EU"/>
            <column name="expression" value="validateFormat(IDS)"/>
            <column name="rule_id" value="10101"/>
            <column name="failure_message" value="Check Format. Must be according to the specified schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10102"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(creationDateTime == null || creationDateTime.dateTime == null) || creationDateTime != null &amp;&amp; creationDateTime.dateTime != null &amp;&amp; isNotUTC(creationDateTime)"/>
            <column name="rule_id" value="10102"/>
            <column name="failure_message" value="Check Format. Must be date in UTC according to ISO8601"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10103"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="creationDateTime != null &amp;&amp; creationDateTime.dateTime != null &amp;&amp; dateNow().before(creationDateTime.dateTime.toDate())"/>
            <column name="rule_id" value="10103"/>
            <column name="failure_message" value="Date must be in the past."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10104"/>
            <column name="context" value="EU"/>
            <column name="expression" value="listIdDoesNotContainAll(purposeCode, &quot;FLUX_GP_PURPOSE&quot;)"/>
            <column name="rule_id" value="10104"/>
            <column name="failure_message" value="Check attribute listID. Must be FLUX_GP_PURPOSE"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10105"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueContainsAny(purposeCode, &quot;9&quot;, &quot;3&quot;, &quot;5&quot;, &quot;1&quot;)"/>
            <column name="rule_id" value="10105"/>
            <column name="failure_message" value="Check code."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10106"/>
            <column name="context" value="EU"/>
            <column name="expression" value="purposeCode != null &amp;&amp; purposeCode.value == &quot;1&quot;"/>
            <column name="rule_id" value="10106"/>
            <column name="failure_message" value="Code for cancellation is not allowed"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10107"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="ownerFLUXParty != null &amp;&amp; schemeIdContainsAll(ownerFLUXParty.getIDS(), &quot;FLUX_GP_PARTY&quot;)"/>
            <column name="rule_id" value="10107"/>
            <column name="failure_message" value="Check attribute listID. Must be FLUX_GP_PARTY"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10108"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isAuction() &amp;&amp; (isReport() &amp;&amp; IDS != null &amp;&amp; IDS.get(0) != null                                     &amp;&amp; IDS.get(0).getValue() != null                                     &amp;&amp; !mdrService.isPresentInMDRList(&quot;FLUX_GP_PARTY&quot;, IDS.get(0).getValue(), creationDateOfMessage))"/>
            <column name="rule_id" value="10108"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10109"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueContainsAny(itemTypeCode, &quot;SN&quot;, &quot;TOD&quot;, &quot;TRD&quot;, &quot;SN+TOD&quot;)"/>
            <column name="rule_id" value="10109"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10110"/>
            <column name="context" value="EU"/>
            <column name="expression" value="valueContainsAny(itemTypeCode, &quot;SN&quot;, &quot;TOD&quot;)"/>
            <column name="rule_id" value="10110"/>
            <column name="failure_message" value="Only SN and TOD allowed"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10111"/>
            <column name="context" value="EU"/>
            <column name="expression" value="hasTheNationalNumberPartOfTheIDAnIncorrectFormat()"/>
            <column name="rule_id" value="10111"/>
            <column name="failure_message" value="Check format of the part corresponding to the national number"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10112"/>
            <column name="context" value="EU"/>
            <column name="expression" value="hasTheCommonPartOfTheIDAnIncorrectFormat()"/>
            <column name="rule_id" value="10112"/>
            <column name="failure_message" value="check format of the common part"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10113"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="currencyCode != null &amp;&amp; !mdrService.isCodeTypePresentInMDRList(currencyCode, creationDateOfMessage)"/>
            <column name="rule_id" value="10113"/>
            <column name="failure_message" value="Check Code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10115"/>
            <column name="context" value="EU"/>
            <column name="expression" value="hasTheTakeOverDocumentIdAnIncorrectFormat()"/>
            <column name="rule_id" value="10115"/>
            <column name="failure_message" value="Check Format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10116"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(salesNoteIDs) &amp;&amp; salesNoteIDs[0] != null &amp;&amp; isInvalidSalesNoteID()"/>
            <column name="rule_id" value="10116"/>
            <column name="failure_message" value="Check Format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10119"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="salesPartiesValueDoesNotContainAny(specifiedSalesParties, &quot;SENDER&quot;)"/>
            <column name="rule_id" value="10119"/>
            <column name="failure_message" value="SENDER role must exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10117"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="ID != null &amp;&amp; ID.getSchemeId() != null                             &amp;&amp; !mdrService.isPresentInMDRList(&quot;FLUX_SALES_PARTY_ID_TYPE&quot;, ID.getSchemeId(), creationDateOfMessage)"/>
            <column name="rule_id" value="10117"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10033"/>
            <column name="context" value="EU"/>
            <column name="expression" value="specifiedFishingTrip == null"/>
            <column name="rule_id" value="10033"/>
            <column name="failure_message" value="Fishing trip must be present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10118"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(roleCodes) &amp;&amp; !mdrService.isTypeCodeValuePresentInList(&quot;FLUX_SALES_PARTY_ROLE&quot;, roleCodes, creationDateOfMessage)"/>
            <column name="rule_id" value="10118"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10120"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!anyValueContainsAll(roleCodes, &quot;CARRIER&quot;)"/>
            <column name="rule_id" value="10120"/>
            <column name="failure_message" value="No code for CARRIER allowed"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10121"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(occurrenceDateTime == null || occurrenceDateTime.dateTime == null) || occurrenceDateTime != null &amp;&amp; occurrenceDateTime.dateTime != null &amp;&amp; isNotUTC(occurrenceDateTime)"/>
            <column name="rule_id" value="10121"/>
            <column name="failure_message" value="Check format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10122"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="speciesCode != null &amp;&amp; speciesCode.getValue() != null                             &amp;&amp; !mdrService.isPresentInMDRList(&quot;FAO_SPECIES&quot;, speciesCode.getValue(), creationDateOfMessage) "/>
            <column name="rule_id" value="10122"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10123"/>
            <column name="context" value="EU"/>
            <column name="expression" value="unitQuantity != null &amp;&amp; unitQuantity.value &lt;  0"/>
            <column name="rule_id" value="10123"/>
            <column name="failure_message" value="Positive number"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10124"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!(weightMeasure == null || &quot;KGM&quot;.equals(weightMeasure.unitCode))"/>
            <column name="rule_id" value="10124"/>
            <column name="failure_message" value="Check unit code: must be KGM"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10125"/>
            <column name="context" value="EU"/>
            <column name="expression" value="weightMeasure != null &amp;&amp; weightMeasure.value &lt;0"/>
            <column name="rule_id" value="10125"/>
            <column name="failure_message" value="Positive number"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10126"/>
            <column name="context" value="EU"/>
            <column name="expression" value="weightMeasure != null &amp;&amp; weightMeasure.value == 0"/>
            <column name="rule_id" value="10126"/>
            <column name="failure_message" value="Weight = 0"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10127"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="weightMeasure != null &amp;&amp; speciesCode != null &amp;&amp; speciesCode.value != null &amp;&amp; !speciesCode.value.equals(&quot;BFT&quot;) &amp;&amp; getNumberOfDecimalPlaces(weightMeasure.value) &gt; 2"/>
            <column name="rule_id" value="10127"/>
            <column name="failure_message" value="No more than 2 decimals"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10129"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="usageCode != null                             &amp;&amp; !mdrService.isPresentInMDRList(&quot;PROD_USAGE&quot;, usageCode.getValue(), creationDateOfMessage)"/>
            <column name="rule_id" value="10129"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10130"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(typeCodes) &amp;&amp; !mdrService.isCodeTypePresentInMDRList(typeCodes, creationDateOfMessage)"/>
            <column name="rule_id" value="10130"/>
            <column name="failure_message" value="Check code from the list listID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10131"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="conversionFactorNumeric != null &amp;&amp; conversionFactorNumeric.value &lt;  0"/>
            <column name="rule_id" value="10131"/>
            <column name="failure_message" value="Positive number"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10132"/>
            <column name="context" value="EU"/>
            <column name="expression" value="valueContainsAny(classCodes, &quot;BMS&quot;,&quot;LSC&quot;)"/>
            <column name="rule_id" value="10132"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10133"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="categoryCode != null                         &amp;&amp; !mdrService.isTypeCodeValuePresentInList(categoryCode.getListId(), categoryCode, creationDateOfMessage)"/>
            <column name="rule_id" value="10133"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10137"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value != null &amp;&amp; !typeCode.value.equals(&quot;LAN&quot;)"/>
            <column name="rule_id" value="10137"/>
            <column name="failure_message" value="Check format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10138"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="startDateTime != null &amp;&amp; startDateTime.dateTime != null &amp;&amp; isNotUTC(startDateTime)"/>
            <column name="rule_id" value="10138"/>
            <column name="failure_message" value="Check format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10139"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="endDateTime != null &amp;&amp; (endDateTime.dateTime == null || endDateTime.dateTime != null &amp;&amp; isNotUTC(endDateTime))"/>
            <column name="rule_id" value="10139"/>
            <column name="failure_message" value="Check format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10159"/>
            <column name="context" value="EU"/>
            <column name="expression" value="validateFormat(IDS)"/>
            <column name="rule_id" value="10159"/>
            <column name="failure_message" value="Check format of the CFR"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10140"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="ID != null &amp;&amp; !mdrService.isIdTypePresentInMDRList(ID, creationDateOfMessage)"/>
            <column name="rule_id" value="10140"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10141"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="roleCodes != null &amp;&amp; valueCodeTypeContainsAny(roleCodes, &quot;MASTER&quot;, &quot;AGENT&quot;, &quot;OWNER&quot;, &quot;OPERATOR&quot;)"/>
            <column name="rule_id" value="10141"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10142"/>
            <column name="context" value="EU"/>
            <column name="expression" value="givenName != null &amp;&amp; isEmpty(givenName.getValue())"/>
            <column name="rule_id" value="10142"/>
            <column name="failure_message" value="Non-empty"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10143"/>
            <column name="context" value="EU"/>
            <column name="expression" value="familyName != null &amp;&amp; isEmpty(familyName.getValue())"/>
            <column name="rule_id" value="10143"/>
            <column name="failure_message" value="Non-empty"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10144"/>
            <column name="context" value="EU"/>
            <column name="expression" value="alias != null &amp;&amp; isEmpty(alias.getValue())"/>
            <column name="rule_id" value="10144"/>
            <column name="failure_message" value="Non-empty"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10145"/>
            <column name="context" value="EU"/>
            <column name="expression" value="IDS != null &amp;&amp; schemeIdContainsAll(IDS, &quot;EU_TRIP_ID&quot;)"/>
            <column name="rule_id" value="10145"/>
            <column name="failure_message" value="Check attribute schemeID. Must be EU_TRIP_ID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10146"/>
            <column name="context" value="EU"/>
            <column name="expression" value="IDS != null &amp;&amp; validateFormat(IDS)"/>
            <column name="rule_id" value="10146"/>
            <column name="failure_message" value="Check format. Must be according to schemeID rules"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10147"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; listIdDoesNotContainAll(typeCode, &quot;FLUX_LOCATION_TYPE&quot;)"/>
            <column name="rule_id" value="10147"/>
            <column name="failure_message" value="Check attribute listID. Must be FLUX_LOCATION_TYPE"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10148"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; valueContainsAny(typeCode, &quot;ADDRESS&quot;,&quot;POSITION&quot;,&quot;LOCATION&quot;,&quot;AREA&quot;)"/>
            <column name="rule_id" value="10148"/>
            <column name="failure_message"
                    value="Check code. Must be existing in the list specified in attribute listID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10149"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="countryID != null &amp;&amp; schemeIdContainsAll(countryID, &quot;TERRITORY&quot;)"/>
            <column name="rule_id" value="10149"/>
            <column name="failure_message" value="Check attribute listID. Must be TERRITORY"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10150"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="countryID != null &amp;&amp; !mdrService.isIdTypePresentInMDRList(countryID, creationDateOfMessage)"/>
            <column name="rule_id" value="10150"/>
            <column name="failure_message"
                    value="Check code. Must be existing in the list specified in attribute listID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10151"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; ID !=null &amp;&amp; !((typeCode.getValue() == &quot;AREA&quot; &amp;&amp; !schemeIdContainsAny(ID, &quot;FAO_AREA&quot;, &quot;TERRITORY&quot;)) || (typeCode.getValue() == &quot;LOCATION&quot; &amp;&amp; !schemeIdContainsAny(ID, &quot;LOCATION&quot;, &quot;FARM&quot;)))"/>
            <column name="rule_id" value="10151"/>
            <column name="failure_message"
                    value="Check attribute listID. In case Type= 'AREA': must be FAO_AREA, TERRITORY, In case Type= 'LOCATION': must be LOCATION, FARM"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10152"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="ID !=null &amp;&amp; &quot;FAO_AREA&quot;.equals(ID.getSchemeId()) &amp;&amp; ID.getValue() != null &amp;&amp; mdrService.isNotMostPreciseFAOArea(ID, creationDateOfMessage)"/>
            <column name="rule_id" value="10152"/>
            <column name="failure_message" value="If FAO_AREA code, the more precise area must be mentioned"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10153"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="ID != null &amp;&amp; !mdrService.isIdTypePresentInMDRList(ID, creationDateOfMessage)"/>
            <column name="rule_id" value="10153"/>
            <column name="failure_message"
                    value="Check code. Must be existing in the list specified in attribute listID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10155"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="latitudeMeasure != null &amp;&amp; latitudeMeasure.getValue() != null &amp;&amp; !isBigDecimalBetween(latitudeMeasure.getValue(), BigDecimal.valueOf(-90), BigDecimal.valueOf(90))"/>
            <column name="rule_id" value="10155"/>
            <column name="failure_message" value="Check range. Must be between -90 and 90"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10157"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="longitudeMeasure != null &amp;&amp; longitudeMeasure.getValue() != null &amp;&amp; !isBigDecimalBetween(longitudeMeasure.getValue(), BigDecimal.valueOf(-180), BigDecimal.valueOf(180))"/>
            <column name="rule_id" value="10157"/>
            <column name="failure_message" value="Check range. Must be between -180 and 180"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10158"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="countryID != null &amp;&amp; !mdrService.isIdTypePresentInMDRList(countryID, creationDateOfMessage)"/>
            <column name="rule_id" value="10158"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10202"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="FLUXReportDocument != null &amp;&amp; FLUXReportDocument.getPurposeCode() != null &amp;&amp; FLUXReportDocument.getPurposeCode().getValue() != &quot;3&quot; &amp;&amp; (salesReports == null || salesReports.size() != 1)"/>
            <column name="rule_id" value="10202"/>
            <column name="failure_message"
                    value="One and only one occurrence of a sales report if purpose is not 'delete'"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10203"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(purposeCode != null &amp;&amp; (purposeCode.getValue().equals(&quot;5&quot;) || purposeCode.getValue().equals(&quot;3&quot;))) &amp;&amp;                      (referencedID == null || salesService.doesReferencedIdNotExist($fact))"/>
            <column name="rule_id" value="10203"/>
            <column name="failure_message"
                    value="If correction or deletion, the referenced identification must be provided and it must be the one of a an existing Sales Report message"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="145"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueCode != null &amp;&amp; (isEmpty(valueCode.listId) || !mdrService.codeListExistsInMdr(valueCode.listId))"/>
            <column name="rule_id" value="145"/>
            <column name="failure_message"
                    value="Check presence of attribute listID. Must be present and have a value of an existing code list in MDR."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10204"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="purposeCode != null &amp;&amp; purposeCode.getValue().equals(&quot;9&quot;) &amp;&amp; referencedID != null &amp;&amp; referencedID.value != null"/>
            <column name="rule_id" value="10204"/>
            <column name="failure_message"
                    value="If it is a new message (creation), the referenced identification must be empty"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10205"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="includedSalesDocuments != null &amp;&amp; includedSalesDocuments.size() != 1"/>
            <column name="rule_id" value="10205"/>
            <column name="failure_message" value="Only one sales document"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10212"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isProviderRoleNotSpecifiedForSalesNote()"/>
            <column name="rule_id" value="10212"/>
            <column name="failure_message" value="PROVIDER role must exist for a SN"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10213"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isBuyerNotSpecifiedForSalesNoteWithPurchase()"/>
            <column name="rule_id" value="10213"/>
            <column name="failure_message"
                    value="SELLER/BUYER role must exist for a SN when products are bought (not withdrawn)"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10214"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isRecipientRoleNotSpecifiedForTakeOverDocument()"/>
            <column name="rule_id" value="10214"/>
            <column name="failure_message" value="RECIPIENT role must exist for a Take-over doc"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10216"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isFluxOrganizationNotSpecifiedOnRecipientOfTakeOverDocument()"/>
            <column name="rule_id" value="10216"/>
            <column name="failure_message" value="Must be present for TOD"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10221"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isSalesNoteIdentifierNotSpecifiedForTakeOverDocumentWithStoredProducts()"/>
            <column name="rule_id" value="10221"/>
            <column name="failure_message"
                    value="For a take-over doc, if the usage code equals 'STO' (Storage), the SN identifier should be communicated"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10206"/>
            <column name="context" value="EU"/>
            <column name="expression" value="specifiedSalesEvents != null &amp;&amp; specifiedSalesEvents.size() != 1"/>
            <column name="rule_id" value="10206"/>
            <column name="failure_message" value="Only one sales event"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10207"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedSalesParties != null &amp;&amp; specifiedSalesParties.size() &lt;2"/>
            <column name="rule_id" value="10207"/>
            <column name="failure_message" value="At least two occurrences"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10208"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isAuction() &amp;&amp; (specifiedFishingActivities != null &amp;&amp; specifiedFishingActivities.size() != 1)"/>
            <column name="rule_id" value="10208"/>
            <column name="failure_message" value="Only one occurrence"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10209"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedFLUXLocations != null &amp;&amp; specifiedFLUXLocations.size() != 1"/>
            <column name="rule_id" value="10209"/>
            <column name="failure_message" value="Only one occurrence"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10210"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedSalesBatches != null &amp;&amp; specifiedSalesBatches.size() != 1"/>
            <column name="rule_id" value="10210"/>
            <column name="failure_message" value="Only one occurrence"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10215"/>
            <column name="context" value="EU"/>
            <column name="expression" value="doesDocumentContainDuplicateSalesPartyRoles()"/>
            <column name="rule_id" value="10215"/>
            <column name="failure_message" value="No duplication of role allowed"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10217"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isAnySalesDateBeforeLandingDate()"/>
            <column name="rule_id" value="10217"/>
            <column name="failure_message" value="Sales Event date &gt;  Start date (landing)"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10211"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="roleCodes != null &amp;&amp; !valueContainsAny(roleCodes, &quot;SENDER&quot;) &amp;&amp; (ID == null || (ID != null &amp;&amp; isEmpty(ID.getValue())))"/>
            <column name="rule_id" value="10211"/>
            <column name="failure_message" value="Identification mandatory when role=SENDER"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10218"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedAAPProducts)"/>
            <column name="rule_id" value="10218"/>
            <column name="failure_message" value="At least one must exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10219"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(unitQuantity == null &amp;&amp; weightMeasure == null) || (unitQuantity != null &amp;&amp; weightMeasure != null)"/>
            <column name="rule_id" value="10219"/>
            <column name="failure_message" value="One of the two must be available"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10224"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isBMSSpeciesAndUsageIsNotForNonDirectHumanConsumption()"/>
            <column name="rule_id" value="10224"/>
            <column name="failure_message" value="Usage must be for non direct human consumption if BMS species"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10238"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isOriginFLUXLocationEmptyOrTypeNotLocation()"/>
            <column name="rule_id" value="10238"/>
            <column name="failure_message" value="It must not be a LOCATION code for AAP products"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10239"/>
            <column name="context" value="EU"/>
            <column name="expression" value="countFAOAreaCodes() == 0"/>
            <column name="rule_id" value="10239"/>
            <column name="failure_message" value="FAO_AREA code is mandatory"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10247"/>
            <column name="context" value="EU"/>
            <column name="expression" value="countFAOAreaCodes() &gt; 1"/>
            <column name="rule_id" value="10247"/>
            <column name="failure_message" value="Only one FAO_AREA code per product"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10222"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isListEmptyOrAllListIdsUnique(typeCodes)"/>
            <column name="rule_id" value="10222"/>
            <column name="failure_message" value="No duplicated type codes"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10223"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="listIdDoesNotContainAll(typeCodes, &quot;FISH_PRESERVATION&quot;, &quot;FISH_PRESENTATION&quot;)"/>
            <column name="rule_id" value="10223"/>
            <column name="failure_message" value="Presentation&amp;preservation must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10225"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!valueContainsAny(classCodes, &quot;BMS&quot;) &amp;&amp; (categoryCode == null || categoryCode.getValue() != &quot;N/A&quot;)"/>
            <column name="rule_id" value="10225"/>
            <column name="failure_message" value="If BMS species, the category should be N/A"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10229"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isListEmptyOrBetweenNumberOfItems(specifiedDelimitedPeriods,1,1)"/>
            <column name="rule_id" value="10229"/>
            <column name="failure_message" value="Only one occurrence"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11530"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isListEmptyOrBetweenNumberOfItems(relatedVesselTransportMeans,1,1)"/>
            <column name="rule_id" value="11530"/>
            <column name="failure_message" value="Only one occurrence"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11539"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isRelatedFLUXLocationsEmptyOrTypeLocation()"/>
            <column name="rule_id" value="11539"/>
            <column name="failure_message" value="It must be a LOCATION code for the landing"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10231"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isListNotEmptyAndBetweenNumberOfItems(specifiedContactParties,1,2)"/>
            <column name="rule_id" value="10231"/>
            <column name="failure_message" value="At least one occurrence and maximum two"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10233"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isListEmptyOrValuesMatchPassedArguments(roleCodes, &quot;MASTER&quot;,&quot;OPERATOR&quot;)"/>
            <column name="rule_id" value="10233"/>
            <column name="failure_message" value="Codes other than master/operator are not allowed"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10234"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(specifiedContactPersons)"/>
            <column name="rule_id" value="10234"/>
            <column name="failure_message" value="Must be present for each party"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10235"/>
            <column name="context" value="EU"/>
            <column name="expression" value="alias == null &amp;&amp; givenName == null"/>
            <column name="rule_id" value="10235"/>
            <column name="failure_message" value="Check presence. Must be present if AliasText is not present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10236"/>
            <column name="context" value="EU"/>
            <column name="expression" value="alias == null &amp;&amp; familyName == null"/>
            <column name="rule_id" value="10236"/>
            <column name="failure_message" value="Check presence. Must be present if AliasText is not present."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10237"/>
            <column name="context" value="EU"/>
            <column name="expression" value="alias == null &amp;&amp; givenName == null &amp;&amp; familyName == null"/>
            <column name="rule_id" value="10237"/>
            <column name="failure_message"
                    value="Check presence. Must be present if GivenNameText or FamilyNameText is not."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10240"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; (typeCode.getValue() == &quot;LOCATION&quot; || typeCode.getValue() == &quot;ADDRESS&quot;) &amp;&amp; countryID == null"/>
            <column name="rule_id" value="10240"/>
            <column name="failure_message" value="Check presence. Must be present if Type is LOCATION or ADDRESS."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10241"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.sale_L02_00_0183($fact)"/>
            <column name="rule_id" value="10241"/>
            <column name="failure_message"
                    value="Check presence. Must be present, unless type is 'POSITION' or 'ADDRESS'"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10242"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="ID != null &amp;&amp; ID.getSchemeId() != null &amp;&amp; &quot;LOCATION&quot;.equals(ID.getSchemeId()) &amp;&amp; (isBlank(countryID) || mdrService.isLocationNotInCountry(ID, countryID, creationDateOfMessage))"/>
            <column name="rule_id" value="10242"/>
            <column name="failure_message" value="If LOCATION code, the place must be in the country"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10243"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="specifiedPhysicalFLUXGeographicalCoordinate == null &amp;&amp; typeCode != null &amp;&amp; typeCode.getValue() == &quot;POSITION&quot;"/>
            <column name="rule_id" value="10243"/>
            <column name="failure_message" value="Check presence. Must be present if Type=POSITION."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10244"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="ID == null &amp;&amp; physicalStructuredAddress == null &amp;&amp; (specifiedPhysicalFLUXGeographicalCoordinate == null || specifiedPhysicalFLUXGeographicalCoordinate.getLongitudeMeasure() == null || specifiedPhysicalFLUXGeographicalCoordinate.getLatitudeMeasure() == null) "/>
            <column name="rule_id" value="10244"/>
            <column name="failure_message"
                    value="Latitude &amp; longitude must be provided if there is no identification and no address"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10245"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; &quot;ADDRESS&quot;.equals(typeCode.getValue()) &amp;&amp; physicalStructuredAddress == null"/>
            <column name="rule_id" value="10245"/>
            <column name="failure_message" value="Check presence. Must be present if location Type is ADDRESS."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10246"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="physicalStructuredAddress != null &amp;&amp; physicalStructuredAddress.countryID != countryID"/>
            <column name="rule_id" value="10246"/>
            <column name="failure_message" value="Should be the same value"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10301"/>
            <column name="context" value="EU"/>
            <column name="expression" value="submittedDateTime == null || submittedDateTime.dateTime == null"/>
            <column name="rule_id" value="10301"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10302"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null || isEmpty(typeCode.getValue())"/>
            <column name="rule_id" value="10302"/>
            <column name="failure_message" value="At least one value must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10303"/>
            <column name="context" value="EU"/>
            <column name="expression" value="specifiedDelimitedPeriod == null"/>
            <column name="rule_id" value="10303"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10304"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(simpleSalesQueryParameters)"/>
            <column name="rule_id" value="10304"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10309"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!anyQueryParameterOfTypeRoleWithValue()"/>
            <column name="rule_id" value="10309"/>
            <column name="failure_message" value="A role must exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10306"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isQuery() &amp;&amp; (startDateTime == null || startDateTime.dateTime == null)"/>
            <column name="rule_id" value="10306"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10307"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isQuery() &amp;&amp; (endDateTime == null || endDateTime.dateTime == null)"/>
            <column name="rule_id" value="10307"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10400"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(IDS) || IDS.get(0) == null"/>
            <column name="rule_id" value="10400"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10401"/>
            <column name="context" value="EU"/>
            <column name="expression" value="referencedID == null"/>
            <column name="rule_id" value="10401"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10402"/>
            <column name="context" value="EU"/>
            <column name="expression" value="responseCode == null"/>
            <column name="rule_id" value="10402"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10403"/>
            <column name="context" value="EU"/>
            <column name="expression" value="creationDateTime == null"/>
            <column name="rule_id" value="10403"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10404"/>
            <column name="context" value="EU"/>
            <column name="expression" value="respondentFLUXParty == null"/>
            <column name="rule_id" value="10404"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10409"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="responseCode != null &amp;&amp; responseCode.getValue != &quot;OK&quot; &amp;&amp; !isEmpty(relatedValidationResultDocuments) &amp;&amp; anyValidationResultDocumentsWithEmptyValidationQualityAnalyses()"/>
            <column name="rule_id" value="10409"/>
            <column name="failure_message" value="Must be present if validation document"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10406"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isResponse() &amp;&amp; (isEmpty(IDS) || IDS.get(0) == null)"/>
            <column name="rule_id" value="10406"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10407"/>
            <column name="context" value="EU"/>
            <column name="expression" value="validatorID == null"/>
            <column name="rule_id" value="10407"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10408"/>
            <column name="context" value="EU"/>
            <column name="expression" value="creationDateTime == null"/>
            <column name="rule_id" value="10408"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10410"/>
            <column name="context" value="EU"/>
            <column name="expression" value="ID == null"/>
            <column name="rule_id" value="10410"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10411"/>
            <column name="context" value="EU"/>
            <column name="expression" value="levelCode == null"/>
            <column name="rule_id" value="10411"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10412"/>
            <column name="context" value="EU"/>
            <column name="expression" value="typeCode == null"/>
            <column name="rule_id" value="10412"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10500"/>
            <column name="context" value="EU"/>
            <column name="expression" value="hasIDInvalidFormat()"/>
            <column name="rule_id" value="10500"/>
            <column name="failure_message" value="Check Format : UUID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10501"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(submittedDateTime == null || submittedDateTime.dateTime == null) || submittedDateTime != null &amp;&amp; submittedDateTime.dateTime != null &amp;&amp; isNotUTC(submittedDateTime)"/>
            <column name="rule_id" value="10501"/>
            <column name="failure_message" value="Check format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10502"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !isCodeTypeValidFormat(&quot;FLUX_SALES_TYPE&quot;, typeCode)"/>
            <column name="rule_id" value="10502"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10503"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isQuery() &amp;&amp; IDS != null &amp;&amp; !IDS.isEmpty() &amp;&amp; IDS.get(0) != null                             &amp;&amp; !mdrService.isPresentInMDRList(&quot;FLUX_GP_PARTY&quot;, IDS.get(0).getValue(), creationDateOfMessage)"/>
            <column name="rule_id" value="10503"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10504"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isQuery() &amp;&amp; ((startDateTime == null || startDateTime.dateTime == null) || (startDateTime != null &amp;&amp; startDateTime.dateTime != null &amp;&amp; isNotUTC(startDateTime)))"/>
            <column name="rule_id" value="10504"/>
            <column name="failure_message" value="Check format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10505"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isQuery() &amp;&amp; ((endDateTime == null || endDateTime.dateTime == null) || (endDateTime != null &amp;&amp; endDateTime.dateTime != null &amp;&amp; isNotUTC(endDateTime)))"/>
            <column name="rule_id" value="10505"/>
            <column name="failure_message" value="Check format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10506"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !isCodeTypeValidFormat(&quot;FLUX_SALES_QUERY_PARAM&quot;, typeCode)"/>
            <column name="rule_id" value="10506"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10507"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; salesService.isSalesQueryParameterValueNotValid(typeCode, valueCode)"/>
            <column name="rule_id" value="10507"/>
            <column name="failure_message" value="If Type = FLAG/ROLE/PLACE, Check code of the value"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10508"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.getValue() == &quot;VESSEL&quot; &amp;&amp; !(valueID == null || isEmpty(valueID.getValue()) || isIdTypeValidFormat(&quot;CFR&quot;, valueID))"/>
            <column name="rule_id" value="10508"/>
            <column name="failure_message" value="If Type=VESSEL, Check format of CFR"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10509"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !valueContainsAny(typeCode, &quot;SALES_ID&quot;,&quot;TRIP_ID&quot;) &amp;&amp; hasTheNationalNumberPartOfTheValueIDAnIncorrectFormat()"/>
            <column name="rule_id" value="10509"/>
            <column name="failure_message"
                    value="If Type = SALES_ID or TRIP_ID: Check format of the part corresponding to the national number"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10510"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !valueContainsAny(typeCode, &quot;SALES_ID&quot;,&quot;TRIP_ID&quot;) &amp;&amp; hasTheCommonPartOfTheValueIDAnIncorrectFormat()"/>
            <column name="rule_id" value="10510"/>
            <column name="failure_message" value="If Type = SALES_ID or TRIP_ID: Check format of the common part"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10600"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(IDS) &amp;&amp; IDS.get(0) != null &amp;&amp; IDS.get(0).getSchemeId() != &quot;UUID&quot;"/>
            <column name="rule_id" value="10600"/>
            <column name="failure_message" value="Check attribute schemeID. Must be UUID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10601"/>
            <column name="context" value="EU"/>
            <column name="expression" value="hasIDInvalidFormat()"/>
            <column name="rule_id" value="10601"/>
            <column name="failure_message" value="Check Format. Must be according to the specified schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10602"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="referencedID != null                             &amp;&amp; !mdrService.isPresentInMDRList(&quot;FLUX_GP_MSG_ID&quot;, referencedID.getSchemeId(), creationDateOfMessage)"/>
            <column name="rule_id" value="10602"/>
            <column name="failure_message" value="Check attribute schemeID. Must be in the FLUX_GP_MSG_ID list"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10603"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!isAuction() &amp;&amp; hasReferencedIDInvalidFormat()"/>
            <column name="rule_id" value="10603"/>
            <column name="failure_message" value="Check Format. Must be according to the specified schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10604"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="responseCode != null &amp;&amp; responseCode.getListId() != &quot;FLUX_GP_RESPONSE&quot;"/>
            <column name="rule_id" value="10604"/>
            <column name="failure_message" value="Check attribute listID. Must be FLUX_GP_RESPONSE"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10605"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="responseCode != null &amp;&amp; !isCodeTypeValidFormat(&quot;FLUX_GP_RESPONSE&quot;, responseCode)"/>
            <column name="rule_id" value="10605"/>
            <column name="failure_message"
                    value="Check value. Code must be value of the specified code list in listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10606"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(creationDateTime == null || creationDateTime.dateTime == null) || creationDateTime != null &amp;&amp; creationDateTime.dateTime != null &amp;&amp; isNotUTC(creationDateTime)"/>
            <column name="rule_id" value="10606"/>
            <column name="failure_message" value="Check Format. Must be date in UTC according to ISO8601"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10607"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isResponse() &amp;&amp; !isEmpty(IDS) &amp;&amp; IDS.get(0) != null &amp;&amp; IDS.get(0).getSchemeId() != null &amp;&amp; !IDS.get(0).getSchemeId().equals(&quot;FLUX_GP_PARTY&quot;)"/>
            <column name="rule_id" value="10607"/>
            <column name="failure_message" value="Check attribute listID. Must be FLUX_GP_PARTY"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10608"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="validatorID != null                             &amp;&amp; !mdrService.isPresentInMDRList(&quot;FLUX_GP_PARTY&quot;, validatorID.value, creationDateOfMessage)"/>
            <column name="rule_id" value="10608"/>
            <column name="failure_message" value="Check code"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10609"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(creationDateTime == null || creationDateTime.dateTime == null) || creationDateTime != null &amp;&amp; creationDateTime.dateTime != null &amp;&amp; isNotUTC(creationDateTime)"/>
            <column name="rule_id" value="10609"/>
            <column name="failure_message" value="Check format"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10610"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isAuction() &amp;&amp; (ID != null &amp;&amp; !mdrService.isPresentInMDRList(ID.schemeId, ID.value, creationDateOfMessage))"/>
            <column name="rule_id" value="10610"/>
            <column name="failure_message"
                    value="Check value. Code must be value of the specified code list in listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10611"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="levelCode != null &amp;&amp; !mdrService.isPresentInMDRList(levelCode.listId, levelCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="10611"/>
            <column name="failure_message" value="Check Code. Must be in the list specified in listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10612"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; !mdrService.isPresentInMDRList(typeCode.listId, typeCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="10612"/>
            <column name="failure_message" value="Check Code. Must be in the list specified in listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10701"/>
            <column name="context" value="EU"/>
            <column name="expression" value="submitterFLUXParty == null"/>
            <column name="rule_id" value="10701"/>
            <column name="failure_message" value="Must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10705"/>
            <column name="context" value="EU"/>
            <column name="expression" value="triesToQueryOnTypeFlagButIsNotAnInternationalOrganization()"/>
            <column name="rule_id" value="10705"/>
            <column name="failure_message" value="Type=FLAG only for international organization"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10706"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="triesToQueryOnTypeRoleAndValueFlagOrLandButIsAnInternationalOrganization() || triesToQueryOnTypeRoleAndValueIntButIsNotAnInternationalOrganization()"/>
            <column name="rule_id" value="10706"/>
            <column name="failure_message"
                    value="Type=ROLE, values FLAG or LAND only for MS INT for international organization"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10704"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isQuery() &amp;&amp; startDateTime != null &amp;&amp; endDateTime != null &amp;&amp; startDateTime.getDateTime() != null &amp;&amp; endDateTime.getDateTime() != null &amp;&amp; startDateTime.getDateTime().getMillis() &gt; endDateTime.getDateTime().getMillis()"/>
            <column name="rule_id" value="10704"/>
            <column name="failure_message" value="Start &lt;  End"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10800"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="responseCode != null &amp;&amp; !responseCode.getValue().equals(&quot;OK&quot;) &amp;&amp; isEmpty(relatedValidationResultDocuments)"/>
            <column name="rule_id" value="10800"/>
            <column name="failure_message" value="Must be present if ResponseCode != OK"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10802"/>
            <column name="context" value="EU"/>
            <column name="expression" value="anyValidationQualityAnalysisWithoutReferencedTextItems()"/>
            <column name="rule_id" value="10802"/>
            <column name="failure_message" value="At least one occurrence if not link with the Sales Report"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10801"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isDateOfValidationAfterCreationDateOfResponse($fact)"/>
            <column name="rule_id" value="10801"/>
            <column name="failure_message" value="The Creation must be &lt;  to the Creation of the report"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10900"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isCorrectionAndIsItemTypeTheSameAsInTheOriginal($fact)"/>
            <column name="rule_id" value="10900"/>
            <column name="failure_message"
                    value="In case of a correction, the item type must be the same as the item type of the referenced report"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10901"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!salesService.doesReportNotExistWithId($fact)"/>
            <column name="rule_id" value="10901"/>
            <column name="failure_message" value="The identification must be unique and not already exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10903"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(isReport() || isQuery()) &amp;&amp; !isEmpty(IDS) &amp;&amp; !matchWithFluxTL(IDS)"/>
            <column name="rule_id" value="10903"/>
            <column name="failure_message" value="Check if OwnerFLUXParty.ID is consistent with FLUX TL values."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10905"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isOriginalAndIsIdNotUnique($fact)"/>
            <column name="rule_id" value="10905"/>
            <column name="failure_message" value="The reference must be unique"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10906"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!salesService.isTheUsedCurrencyAnOfficialCurrencyOfTheCountryAtTheDateOfTheSales($fact)"/>
            <column name="rule_id" value="10906"/>
            <column name="failure_message" value="It must be an official currency of the country at that date"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10908"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!salesService.doesTakeOverDocumentIdExist($fact)"/>
            <column name="rule_id" value="10908"/>
            <column name="failure_message" value="The reference must exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10909"/>
            <column name="context" value="EU"/>
            <column name="expression" value="!salesService.doesSalesNoteIdExist($fact)"/>
            <column name="rule_id" value="10909"/>
            <column name="failure_message" value="The reference must exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10911"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueContainsMatch(roleCodes, &quot;SENDER&quot;) &amp;&amp; ID != null &amp;&amp; ID.schemeId != null &amp;&amp; !ID.schemeId.equals(&quot;MS&quot;)"/>
            <column name="rule_id" value="10911"/>
            <column name="failure_message" value="If SENDER role, it should be a MS Identification"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10912"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isReceptionDate24hAfterSaleDate($fact)"/>
            <column name="rule_id" value="10912"/>
            <column name="failure_message"
                    value="The reception date (by Market state) should not be later than 24h after the sale date"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10914"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isReceptionDate24hAfterLandingDeclaration($fact)"/>
            <column name="rule_id" value="10914"/>
            <column name="failure_message"
                    value="The reception date (by the Take-Over state) should not be later than 24h after the landing declaration date"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10915"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isCFRInFleetUnderFlagStateOnLandingDate($fact)"/>
            <column name="rule_id" value="10915"/>
            <column name="failure_message"
                    value="If CFR, the vessel should be in the EU fleet under the flag state at landing date"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11000"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isIdNotUnique($fact)"/>
            <column name="rule_id" value="11000"/>
            <column name="failure_message" value="The reference must be unique"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11001"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isStartDateMoreThan3YearsAgo($fact)"/>
            <column name="rule_id" value="11001"/>
            <column name="failure_message" value="StartDate &gt;  SystemDate – 3 years"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11100"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isIdNotUnique($fact)"/>
            <column name="rule_id" value="11100"/>
            <column name="failure_message" value="The identification must be unique and not already exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11101"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.doesReferencedIdNotExist($fact)"/>
            <column name="rule_id" value="11101"/>
            <column name="failure_message" value="Must be a reference of a query or sales declaration"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11103"/>
            <column name="context" value="EU"/>
            <column name="expression" value="salesService.isDateNotInPast($fact)"/>
            <column name="rule_id" value="11103"/>
            <column name="failure_message" value="Date must be in the past."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11104"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isResponse() &amp;&amp; IDS != null &amp;&amp; !matchWithFluxTL(IDS)"/>
            <column name="rule_id" value="11104"/>
            <column name="failure_message" value="Check if RespondentFLUXParty.ID is consistent with FLUX TL values."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11704"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isAuction() &amp;&amp; (!valueCodeTypeContainsAny(roleCodes, &quot;SENDER&quot;) &amp;&amp; (ID != null &amp;&amp; ID.value != null &amp;&amp; !ID.value.startsWith(&quot;RB-&quot;)))"/>
            <column name="rule_id" value="11704"/>
            <column name="failure_message" value="ID of Sales Party must start with RB- when the party is a sender"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11705"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isAuction() &amp;&amp; (names.size() != 0)"/>
            <column name="rule_id" value="11705"/>
            <column name="failure_message" value="The name of the class 'FLUX_Party' must never be filled in "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11706"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isAuction() &amp;&amp; (purposeCode != null &amp;&amp; purposeCode.value != null &amp;&amp; purposeCode.value.equals(&quot;3&quot;))"/>
            <column name="rule_id" value="11706"/>
            <column name="failure_message" value="The BEL:SALE class cannot be deleted"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11707"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isVariousSupply() &amp;&amp; (countryCode == null || countryCode.equals(&quot;&quot;))"/>
            <column name="rule_id" value="11707"/>
            <column name="failure_message" value="BEL:SALECountry is mandatory "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11709"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="isAuction() &amp;&amp; countryCode != null &amp;&amp; !mdrService.isPresentInMDRList(&quot;TERRITORY&quot;, countryCode, creationDateOfMessage)"/>
            <column name="rule_id" value="11709"/>
            <column name="failure_message" value="BEL:SALECountry: code should exist in MDR"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11708"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isVariousSupply() &amp;&amp; (specifiedFishingActivities.size() != 0)"/>
            <column name="rule_id" value="11708"/>
            <column name="failure_message" value="FishingActivity:Fishing_activity should not exist"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="11710"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isAuction() &amp;&amp; isVariousSupply() &amp;&amp; isEmpty(supplier)"/>
            <column name="rule_id" value="11710"/>
            <column name="failure_message" value="BEL:SALESupplier is mandatory"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="12000"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="referencedID != null &amp;&amp; schemeIdContainsAll(referencedID, &quot;UUID&quot;)"/>
            <column name="rule_id" value="12000"/>
            <column name="failure_message" value="Check attribute schemeID. Must be UUID"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="12001"/>
            <column name="context" value="EU"/>
            <column name="expression" value="referencedID != null &amp;&amp; validateFormat(referencedID)"/>
            <column name="rule_id" value="12001"/>
            <column name="failure_message" value="Check Format. Must be according to the specified schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="191"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; schemeIdContainsAny(ids, &quot;EU_TRIP_ID&quot;)"/>
            <column name="rule_id" value="191"/>
            <column name="failure_message" value="Trip ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="53"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(ids) &amp;&amp; !schemeIdContainsAny(ids, &quot;IRCS&quot;, &quot;EXT_MARK&quot;) &amp;&amp; schemeIdContainsAll(ids, &quot;IRCS&quot;, &quot;EXT_MARK&quot;)"/>
            <column name="rule_id" value="53"/>
            <column name="failure_message" value="IRCS or external marking missing"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="271"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(relatedVesselTransportMeansIDs) &amp;&amp; mdrService.validateFormat(relatedVesselTransportMeansIDs, creationDateOfMessage)"/>
            <column name="rule_id" value="271"/>
            <column name="failure_message" value="ID of the related vessel is invalid."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="427"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(relatedFishingActivityFaCatchTypeCodes)"/>
            <column name="rule_id" value="427"/>
            <column name="failure_message" value="Catch TypeCode must be present for this joint fishing operation."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="253"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; codeTypeValueEquals(fishingActivityTypeCode, &quot;RELOCATION&quot;) &amp;&amp; codeTypeValueEquals(speciesCode, &quot;BFT&quot;) &amp;&amp; isEmpty(destinationFLUXLocations)"/>
            <column name="rule_id" value="253"/>
            <column name="failure_message" value="Destination location of the BFT catches missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="139"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="affectedQuantity != null &amp;&amp; affectedQuantity.value != null &amp;&amp; !isStrictPositiveInteger(affectedQuantity.value)"/>
            <column name="rule_id" value="139"/>
            <column name="failure_message" value="Affected quantity must be a positive integer."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="180"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(resultAAPProductPackagingUnitQuantity) &amp;&amp; !isStrictPositiveInteger(resultAAPProductPackagingUnitQuantity)"/>
            <column name="rule_id" value="180"/>
            <column name="failure_message" value="The number of packages must be a positive integer number."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="162"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(speciesCode, &quot;BFT&quot;) &amp;&amp; isStrictPositive(weightMeasure) &amp;&amp; !((subActivity &amp;&amp; codeTypeValueEquals(fishingActivityTypeCode, &quot;RELOCATION&quot;)) || (!subActivity &amp;&amp; codeTypeValueEquals(fishingActivityTypeCode, &quot;AREA_ENTRY&quot;) || codeTypeValueEquals(fishingActivityTypeCode, &quot;AREA_EXIT&quot;))) &amp;&amp; (weighingMeansCode == null || isEmpty(weighingMeansCode.value))"/>
            <column name="rule_id" value="162"/>
            <column name="failure_message"
                    value="Check presence. Must be present if species is BFT with weight &gt; 0 (kg).                     The rule does not apply neither to relocation sub-activity nor to an area entry or exit (as main activity)                     where WeighingMeansCode is not mandatory to be reported for the catches."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="183"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(resultAAPProductWeightMeasure) &amp;&amp; !isStrictPositive(resultAAPProductWeightMeasure)"/>
            <column name="rule_id" value="183"/>
            <column name="failure_message" value="The product weight must be a positive number."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="174"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(appliedAAPProcessConversionFactorNumber) &amp;&amp; !isEquals(appliedAAPProcessConversionFactorNumber, 0) &amp;&amp; !isGreaterOrEquals(appliedAAPProcessConversionFactorNumber, 1)"/>
            <column name="rule_id" value="174"/>
            <column name="failure_message" value="The value of the conversion factor must be a positive number."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="338"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="fluxCharacteristicType == &quot;SpecifiedFLUXCharacteristic&quot; &amp;&amp; codeTypeValueEquals(typeCode, &quot;NB_CAGES_TOWED&quot;) &amp;&amp; (!isInteger(valueQuantity.value) || !isPositiveOrZero(valueQuantity.value))"/>
            <column name="rule_id" value="338"/>
            <column name="failure_message"
                    value="If the value of TypeCode is NB_CAGES_TOWED the value must be a positive integer number."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="340"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(flapDocumentIdTypes) &amp;&amp; !mdrService.isAllSchemeIdsPresentInMDRList(&quot;FLAP_ID_TYPE&quot; , flapDocumentIdTypes, creationDateOfMessage) "/>
            <column name="rule_id" value="340"/>
            <column name="failure_message"
                    value="Fishing License, Authorization or Permit ID has an invalid schemeID. "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="448"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !isEmpty(specifiedFLAPDocuments) &amp;&amp; !isEmpty(faCatchSpeciesCodes) &amp;&amp; !valueContainsAny(faCatchSpeciesCodes,&quot;BFT&quot;) &amp;&amp; schemeIdContainsAny(flapDocumentIdTypes, &quot;ICCAT_AUTHORIZATION&quot;)"/>
            <column name="rule_id" value="448"/>
            <column name="failure_message"
                    value="Fishing License, Authorization or Permit ID has an invalid schemeID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="339"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; (specifiedFLAPDocuments != null  &amp;&amp; specifiedFLAPDocuments.size != 0 ) &amp;&amp; isEmpty(flapDocumentIdTypes) &amp;&amp; !valueContainsAny(faCatchSpeciesCodes, &quot;BFT&quot;)"/>
            <column name="rule_id" value="339"/>
            <column name="failure_message" value="Fishing License, Authorization or Permit ID is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="269"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; !valueContainsAny(specifiedFACatchTypeCodes, &quot;UNLOADED&quot;) &amp;&amp; !valueContainsAny(specifiedFACatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; isEmpty(destinationVesselStorageCharacteristic)"/>
            <column name="rule_id" value="269"/>
            <column name="failure_message" value="Destination vessel storage information is missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="449"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; specifiedFLAPDocuments != null &amp;&amp; specifiedFLAPDocuments.size == 0 &amp;&amp; !valueContainsAny(faCatchSpeciesCodes, &quot;BFT&quot;)"/>
            <column name="rule_id" value="449"/>
            <column name="failure_message"
                    value="Check presence. Must be present if the activity is a relocation or transhipment declaration and SpecifiedFACatch/SpeciesCode = BFT"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="335"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!valueContainsAny(faCatchSpeciesCodes, &quot;BFT&quot;) &amp;&amp; (fishingActivityTypeCode.value == &quot;RELOCATION&quot; &amp;&amp; isEmpty(fluxCharacteristicTypeCodes))"/>
            <column name="rule_id" value="335"/>
            <column name="failure_message" value="FLUX Characteristics missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="223"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; (mdrService.getDataTypeForMDRList(&quot;FA_CHARACTERISTIC&quot;, typeCode.value) == &quot;NUMBER&quot; || mdrService.getDataTypeForMDRList(&quot;FA_CHARACTERISTIC&quot;, typeCode.value) == &quot;MEASURE&quot;) &amp;&amp; valueMeasure == null"/>
            <column name="rule_id" value="223"/>
            <column name="failure_message"
                    value="If UN_DATA_TYPE for the characteristic (specified in FLUXCharacteristic/TypeCode) is MEASURE or NUMBER, ValueMeasure must be present and have a value"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="128"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value !=null &amp;&amp; (mdrService.getDataTypeForMDRList(&quot;FA_GEAR_CHARACTERISTIC&quot; , typeCode.value) == &quot;NUMBER&quot; || mdrService.getDataTypeForMDRList(&quot;FA_GEAR_CHARACTERISTIC&quot; , typeCode.value) == &quot;MEASURE&quot;) &amp;&amp; valueMeasure == null"/>
            <column name="rule_id" value="128"/>
            <column name="failure_message"
                    value="If UN_DATA_TYPE for the characteristic (specified in FLUXCharacteristic/TypeCode) is MEASURE or NUMBER, ValueMeasure must be present and have a value"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="225"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; typeCode.value != null &amp;&amp; mdrService.getDataTypeForMDRList(&quot;FA_CHARACTERISTIC&quot;, typeCode.value) == &quot;BOOLEAN&quot; &amp;&amp; (valueIndicator == null || valueIndicator.isIndicator() == null)"/>
            <column name="rule_id" value="225"/>
            <column name="failure_message"
                    value="If UN_DATA_TYPE23 for the characteristic (specified in FLUXCharacteristic/TypeCode) is BOOLEAN, ValueIndicator must be present and have a value."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="171"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(appliedAAPProcess) &amp;&amp; isEmpty(appliedAAPProcessTypeCodes) ||              (listIdNotContains(appliedAAPProcessTypeCodes,&quot;FISH_PRESENTATION&quot;) || listIdNotContains(appliedAAPProcessTypeCodes,&quot;FISH_PRESERVATION&quot;))             &amp;&amp; (fishingActivityTypeCode != null &amp;&amp; !valueContainsAny(fishingActivityTypeCode,&quot;LANDING&quot;,&quot;TRANSHIPMENT&quot;))             &amp;&amp; (typeCode != null &amp;&amp; !valueContainsAny(typeCode,&quot;LOADED&quot;,&quot;UNLOADED&quot;))"/>
            <column name="rule_id" value="171"/>
            <column name="failure_message"
                    value="At least presentation (and for landing and transhipment as well preservation) of the fish must be provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="159"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp;                     !(codeTypeValueEquals(faReportDocumentTypeCode, &quot;DECLARATION&quot;) &amp;&amp; (codeTypeValueEquals(fishingActivityTypeCode, &quot;LANDING&quot;) ||                     codeTypeValueEquals(fishingActivityTypeCode, &quot;TRANSHIPMENT&quot;))) &amp;&amp;                     (codeTypeValueEquals(typeCode, &quot;UNLOADED&quot;) || codeTypeValueEquals(typeCode, &quot;LOADED&quot;)) &amp;&amp;                     (weightMeasure == null || weightMeasure.value == null)"/>
            <column name="rule_id" value="159"/>
            <column name="failure_message"
                    value="Check presence. Must be present if FishingActivity/TypeCode is not equal to not LANDING nor TRANSHIPMENT declaration."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="74"/>
            <column name="context" value="EU"/>
            <column name="expression" value="checkContactListContainsAny(specifiedContactPersons, true, false)"/>
            <column name="rule_id" value="74"/>
            <column name="failure_message" value="Family name of the contact missing as no contact alias is provided."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="31"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(nonUniqueIdsList) &amp;&amp; containsAny(relatedFLUXReportDocumentIDs, nonUniqueIdsList)"/>
            <column name="rule_id" value="31"/>
            <column name="failure_message" value="Report ID already exists."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="107"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity &amp;&amp; codeTypeValueEquals(faReportDocumentTypeCode, &quot;DECLARATION&quot;) &amp;&amp; !valueContainsAny(typeCode, &quot;LANDING&quot;, &quot;TRANSHIPMENT&quot;) &amp;&amp; !validDelimitedPeriod(delimitedPeriod, true, false)"/>
            <column name="rule_id" value="107"/>
            <column name="failure_message"
                    value="StartDateTime must be present if FishingActivity/TypeCode is LANDING or TRANSHIPMENT declaration"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="202"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(typeCode != null &amp;&amp; id != null) &amp;&amp;                             ((typeCode.value == &quot;AREA&quot; &amp;&amp; id.schemeId != &quot;FAO_AREA&quot; &amp;&amp; id.schemeId != &quot;STAT_RECTANGLE&quot; &amp;&amp;                              id.schemeId != &quot;MANAGEMENT_AREA&quot; &amp;&amp; id.schemeId != &quot;TERRITORY&quot; &amp;&amp; id.schemeId != &quot;EFFORT_ZONE&quot; &amp;&amp;                              id.schemeId != &quot;GFCM_GSA&quot; &amp;&amp; id.schemeId != &quot;STAT_RECTANGLE&quot; &amp;&amp; id.schemeId != &quot;GFCM_STAT_RECTANGLE&quot;)                              ||                             (typeCode.value == &quot;LOCATION&quot; &amp;&amp; id.schemeId != &quot;LOCATION&quot; &amp;&amp; id.schemeId != &quot;FARM&quot;))"/>
            <column name="rule_id" value="202"/>
            <column name="failure_message"
                    value="Check attribute schemeID of ID. In case TypeCode= AREA the schemeID must be FAO_AREA, STAT_RECTANGLE, TERRITORY, EFFORT_ZONE, GFCM_GSA, MANAGEMENT_AREA. In case TypeCode= LOCATION: the schemeID must be LOCATION or FARM"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="38"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="&quot;PULL&quot;.equals(messageType) &amp;&amp; (referencedID != null || (purposeCode != null &amp;&amp; (purposeCode.value == &quot;1&quot; || purposeCode.value == &quot;5&quot; || purposeCode.value == &quot;3&quot;))) &amp;&amp; referencedID != null &amp;&amp; referencedID.schemeId == &quot;UUID&quot; &amp;&amp; !mdrService.validateFormat(referencedID, creationDateOfMessage) &amp;&amp; !containsAny(nonUniqueIdsList, Arrays.asList(referencedID))"/>
            <column name="rule_id" value="38"/>
            <column name="failure_message" value="Referenced Report ID does not refer to an acknowledged Report ID "/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="108"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(faReportDocumentTypeCode, &quot;DECLARATION&quot;) &amp;&amp; !subActivity &amp;&amp; !valueContainsAny(typeCode, &quot;LANDING&quot;, &quot;TRANSHIPMENT&quot;) &amp;&amp; !validDelimitedPeriod(delimitedPeriod, false, true)"/>
            <column name="rule_id" value="108"/>
            <column name="failure_message"
                    value="EndDateTime must be present if FishingActivity/TypeCode is LANDING or TRANSHIPMENT declaration"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="218"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="typeCode != null &amp;&amp; (typeCode.value == &quot;FISHING_OPERATION&quot; || typeCode.value == &quot;JOINT_FISHING_OPERATION&quot; || typeCode.value == &quot;GEAR_SHOT&quot; || typeCode.value == &quot;GEAR_RETRIEVAL&quot; || typeCode.value == &quot;DISCARD&quot; || typeCode.value == &quot;RELOCATION&quot; ) &amp;&amp; isEmpty(relatedFluxLocationRFMOCodeList) &amp;&amp; !rfmoProvided(relatedFLUXLocations)"/>
            <column name="rule_id" value="218"/>
            <column name="failure_message" value="RFMO code missing."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="306"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!containsAny(relatedFLUXReportDocumentIDs, nonUniqueIdsList) &amp;&amp; (codeTypeValueEquals(typeCode, &quot;DECLARATION&quot;) &amp;&amp; codeTypeValueEquals(purposeCode, &quot;9&quot;) &amp;&amp; (containsMoreThenOneDeclarationPerTrip(faTypesPerTrip, FishingActivityType.ARRIVAL) || containsMoreThenOneArrivalOrDeparture(FishingActivityType.ARRIVAL) || containsMoreThenOneArrivalOrDepartureInFaReportsOfTheMessage(FishingActivityType.ARRIVAL)))"/>
            <column name="rule_id" value="306"/>
            <column name="failure_message" value="There can only be one arrival declaration in the trip."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="10041"/>
            <column name="context" value="EU"/>
            <column name="expression" value="isEmpty(IDS)"/>
            <column name="rule_id" value="10041"/>
            <column name="failure_message" value="Identification in FishingTrip must be present"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="600"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(typeCode, &quot;AREA_ENTRY&quot;) &amp;&amp; (speciesTargetCode == null || (speciesTargetCode.listId != &quot;TARGET_SPECIES_GROUP&quot;))"/>
            <column name="rule_id" value="600"/>
            <column name="failure_message" value="TBU from MDR"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="601"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="(codeTypeValueEquals(typeCode, &quot;FISHING_OPERATION&quot;) || codeTypeValueEquals(typeCode, &quot;JOINT_FISHING_OPERATION&quot;) || codeTypeValueEquals(typeCode, &quot;AREA_EXIT&quot;))                          &amp;&amp; (speciesTargetCode == null || (speciesTargetCode.listId != &quot;FAO_SPECIES&quot;))"/>
            <column name="rule_id" value="601"/>
            <column name="failure_message" value="TBU from MDR"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="605"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!subActivity  &amp;&amp; codeTypeValueEquals(faReportDocumentTypeCode, &quot;DECLARATION&quot;) &amp;&amp; codeTypeValueEquals(typeCode, &quot;JOINT_FISHING_OPERATION&quot;) &amp;&amp; atMostOneVTMRoleCodeWithValue(&quot;CATCHING_VESSEL&quot;)"/>
            <column name="rule_id" value="605"/>
            <column name="failure_message"
                    value="Check value. If the activity is a joint fishing operation declaration, there cannot be more than one occurrence of VesselTransportMeans/RoleCode = 'CATCHING_VESSEL' for the Related- and SpecifiedVesselTransportMeans entities in this FAReportDocument."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="175"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(appliedAAPProcess) &amp;&amp; isEmpty(appliedAAPProcessConversionFactorNumber) &amp;&amp; !mdrService.combinationExistsInConversionFactorList(specifiedFLUXLocations, appliedAAPProcessTypeCodes, speciesCode, creationDateOfMessage, farepDocSpecVesselTrpmRegVesselCountryId)"/>
            <column name="rule_id" value="175"/>
            <column name="failure_message"
                    value="Must be present if no conversion factor available for combination of FISH_PRESENTATION, FISH_PRESERVATION, Species and if applicable Area"/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="146"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueCode != null &amp;&amp; !isEmpty(valueCode.listId) &amp;&amp; !mdrService.isPresentInMDRList(valueCode.listId, valueCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="146"/>
            <column name="failure_message"
                    value="Check value. Must be existing on the MDR code list specified in listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="610"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="codeTypeValueEquals(faReportDocumentTypeCode, &quot;DECLARATION&quot;) &amp;&amp; !noCatchesDeclaredForCodeTypes(&quot;GEAR_SHOT&quot;, &quot;GEAR_RETRIEVAL&quot;)"/>
            <column name="rule_id" value="610"/>
            <column name="failure_message"
                    value="If the activity is a fishing operation declaration and the  RelatedFishingActivity/TypeCode is either GEAR_SHOT or GEAR_RETRIEVAL, then the  RelatedFishingActivity shall not contain SpecifiedFACatch entities."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="147"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueCode != null &amp;&amp; (isEmpty(valueCode.listId) || !mdrService.codeListExistsInMdr(valueCode.listId))"/>
            <column name="rule_id" value="147"/>
            <column name="failure_message"
                    value="Check presence of attribute listID. Must be present and have a value of an existing code list in MDR."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="148"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="valueCode != null &amp;&amp; !isEmpty(valueCode.listId) &amp;&amp; !mdrService.isPresentInMDRList(valueCode.listId, valueCode.value, creationDateOfMessage)"/>
            <column name="rule_id" value="148"/>
            <column name="failure_message"
                    value="Check value. Must be existing on the MDR code list specified in listID."/>
        </insert>

        <insert tableName="context_expression">
            <column name="id" value="188"/>
            <column name="context" value="EU"/>
            <column name="expression"
                    value="!isEmpty(appliedAAPProcess) &amp;&amp; (appliedAAPProcess.size() &gt; 1) &amp;&amp;  !containsAtLeastOneCFGreaterThenOne() &amp;&amp; !mdrService.combinationExistsInConversionFactorListAndIsGreaterOrEqualToOne(specifiedFLUXLocations, appliedAAPProcess, speciesCode, creationDateOfMessage, farepDocSpecVesselTrpmRegVesselCountryId)"/>
            <column name="rule_id" value="188"/>
            <column name="failure_message"
                    value="If more than one AppliedAAPProcess is present for one FACatch, there must be at least one occurrence where CF &gt; 1 which means : a)  there must be at least one occurrence where ConversionFactorNumeric &gt; 1 or b)  a conversion factor exists in the CONVERSION_FACTOR code list (MDR) for the combination of parameters and has a value &gt; 1."/>
        </insert>

    </changeSet>

</databaseChangeLog>